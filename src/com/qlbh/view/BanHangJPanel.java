/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.qlbh.view;

import com.qlbh.dao.ChiTietHoaDonDAO;
import com.qlbh.dao.HoaDonDAO;
import com.qlbh.dao.KhachHangDAO;
import com.qlbh.dao.NhanVienDAO;
import com.qlbh.dao.SanPhamDAO;
import com.qlbh.dao.UserDAO;
import com.qlbh.model.ChiTietHoaDon;
import com.qlbh.model.HoaDon;
import com.qlbh.model.KhachHang;
import com.qlbh.model.NhanVien;
import com.qlbh.model.SanPham;
import com.qlbh.model.User;
import com.qlbh.tools.Excel;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.sql.Timestamp;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author HoangDucTung
 */
public class BanHangJPanel extends javax.swing.JPanel {

    /**
     * Creates new form BanHangJPanel
     */
    DefaultTableModel thanhVienDefaultTableModel;
    DefaultTableModel koThanhVienDefaultTableModel;
    DefaultTableModel sanPhamThanhVienDefaultTableModel;
    DefaultTableModel sanPhamKhongThanhVienDefaultTableModel;
    ArrayList<HoaDon> listHoaDon = new ArrayList<>();
    ArrayList<SanPham> listSanPham = new ArrayList<>();
    ArrayList<KhachHang> listKhachHang = new ArrayList<>();
    ImageIcon sai = new ImageIcon("tinhsai.png");
    ImageIcon dung = new ImageIcon("dau-check.png");
    DecimalFormat format = new DecimalFormat("###,###,###");
    DecimalFormat format2 = new DecimalFormat("### ### ###");

    User user = null;

    public BanHangJPanel(String username) {
        initComponents();
        user = UserDAO.getMotUser(username);
        thanhVienDefaultTableModel = (DefaultTableModel) banhangTVjTable.getModel();
        koThanhVienDefaultTableModel = (DefaultTableModel) banHangKTVjTable.getModel();
        sanPhamThanhVienDefaultTableModel = (DefaultTableModel) sanPhamBHTVjTable.getModel();
        sanPhamKhongThanhVienDefaultTableModel = (DefaultTableModel) sanPhamBHKTVjTable.getModel();

        loadMaKhachHang("");
        loadMaSanPham();
        loadMaSanPhamBHKTV();
        //loadBanHang();

        maNhanVienBHKTVjTextField.setText(username.toUpperCase());
        maNhanVienBHTVjTextField.setText(username.toUpperCase());
        maNhanVienBHKTVjTextField.setEditable(false);
        maNhanVienBHTVjTextField.setEditable(false);
        maDonHangBHKTVjTextField.setEditable(false);
        maDonHangBHtvjTextField.setEditable(false);
        ngayMuaBHKTVjTextField.setEditable(false);
        ngayMuaBHTVjTextField.setEditable(false);

        huyBHtvjButton.setEnabled(false);
        huyBHKTVjButton.setEnabled(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        thanhVienjPanel = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        banhangTVjTable = new javax.swing.JTable();
        maDonHangBHtvjLabel = new javax.swing.JLabel();
        maSanPhamBHtvjLabel = new javax.swing.JLabel();
        maSanPhamBHtvjComboBox = new javax.swing.JComboBox<>();
        xuatBHtvjButton = new javax.swing.JButton();
        maKhachHangBHtvjLabel = new javax.swing.JLabel();
        suaBHtvjButton = new javax.swing.JButton();
        ngayMuaBHTVjTextField = new javax.swing.JTextField();
        soLuongBHtvjLabel = new javax.swing.JLabel();
        soLuongBHtvjTextField = new javax.swing.JTextField();
        maNhanVienBHtvjLabel = new javax.swing.JLabel();
        maDonHangBHtvjTextField = new javax.swing.JTextField();
        huyBHtvjButton = new javax.swing.JButton();
        themBHtvjButton = new javax.swing.JButton();
        xoaBHtvjButton = new javax.swing.JButton();
        maKhachHangBHTVjComboBox = new javax.swing.JComboBox<>();
        jScrollPane3 = new javax.swing.JScrollPane();
        sanPhamBHTVjTable = new javax.swing.JTable();
        themSPBHTVjButton = new javax.swing.JButton();
        ngayMuaBHtvjLabel = new javax.swing.JLabel();
        maNhanVienBHTVjTextField = new javax.swing.JTextField();
        inHoaDonBHTVjButton = new javax.swing.JButton();
        xemTatCaDonHangBHTVjButton = new javax.swing.JButton();
        suaSPBHTVjButton = new javax.swing.JButton();
        xoaSPBHTVjButton = new javax.swing.JButton();
        locDonHangBHTVjButton = new javax.swing.JButton();
        khongThanhVienjPanel = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        banHangKTVjTable = new javax.swing.JTable();
        maDonHangBHKTVjLabel = new javax.swing.JLabel();
        hoTenBHKTVjLabel = new javax.swing.JLabel();
        themBHKTVjButton = new javax.swing.JButton();
        huyBHKTVjButton = new javax.swing.JButton();
        maDonHangBHKTVjTextField = new javax.swing.JTextField();
        hoTenBHKTVjTextField = new javax.swing.JTextField();
        soDienThoaiBHKTVjLabel = new javax.swing.JLabel();
        soLuongBHktvjLabel = new javax.swing.JLabel();
        soDienThoaiBHKTVjTextField = new javax.swing.JTextField();
        soLuongBHKTVjTextField = new javax.swing.JTextField();
        maSanPhamBHKTVjLabel = new javax.swing.JLabel();
        maSanPhamBHKTVjComboBox = new javax.swing.JComboBox<>();
        maNhanVienBHKTVjLabel = new javax.swing.JLabel();
        maNhanVienBHKTVjTextField = new javax.swing.JTextField();
        diaChiBHKTVjLabel = new javax.swing.JLabel();
        diaChiBHKTVjTextField = new javax.swing.JTextField();
        suaBHKTVjButton = new javax.swing.JButton();
        xuatBHKTVjButton = new javax.swing.JButton();
        xoaBHKTVjButton = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        sanPhamBHKTVjTable = new javax.swing.JTable();
        themSPBHKTVjButton = new javax.swing.JButton();
        ngayMuaBHtvjLabel1 = new javax.swing.JLabel();
        ngayMuaBHKTVjTextField = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        inHoaDonBHKTVjButton = new javax.swing.JButton();
        suaSPBHKTVjButton = new javax.swing.JButton();
        xoaSPBHKTVjButton = new javax.swing.JButton();
        xemTatCaDonHangBHKTVjButton = new javax.swing.JButton();
        locDonHangBHKTVjButton = new javax.swing.JButton();

        setBackground(new java.awt.Color(0, 102, 102));

        jLabel1.setFont(new java.awt.Font("Arial", 1, 36)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("BÁN HÀNG");

        thanhVienjPanel.setBackground(new java.awt.Color(255, 255, 255));

        banhangTVjTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã đơn hàng", "Mã khách hàng", "Tên khách hàng", "Mã sản phẩm", "Tên sản phẩm", "Đơn giá", "Số lượng", "Thành tiền", "Ngày mua", "Mã nhân viên"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        banhangTVjTable.getTableHeader().setReorderingAllowed(false);
        banhangTVjTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                banhangTVjTableMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(banhangTVjTable);
        if (banhangTVjTable.getColumnModel().getColumnCount() > 0) {
            banhangTVjTable.getColumnModel().getColumn(0).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(1).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(2).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(3).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(4).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(5).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(6).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(7).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(8).setResizable(false);
            banhangTVjTable.getColumnModel().getColumn(9).setResizable(false);
        }

        maDonHangBHtvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maDonHangBHtvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maDonHangBHtvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/business-card-of-folded-diptych-design.png"))); // NOI18N
        maDonHangBHtvjLabel.setText("Mã đơn hàng");

        maSanPhamBHtvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maSanPhamBHtvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maSanPhamBHtvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/business-card-of-folded-diptych-design.png"))); // NOI18N
        maSanPhamBHtvjLabel.setText("Mã sản phẩm");

        maSanPhamBHtvjComboBox.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maSanPhamBHtvjComboBox.setForeground(new java.awt.Color(0, 102, 102));
        maSanPhamBHtvjComboBox.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                maSanPhamBHtvjComboBoxActionPerformed(evt);
            }
        });

        xuatBHtvjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        xuatBHtvjButton.setForeground(new java.awt.Color(0, 102, 102));
        xuatBHtvjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/sharebh.png"))); // NOI18N
        xuatBHtvjButton.setText("XUẤT");
        xuatBHtvjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xuatBHtvjButtonActionPerformed(evt);
            }
        });

        maKhachHangBHtvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maKhachHangBHtvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maKhachHangBHtvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/id-card.png"))); // NOI18N
        maKhachHangBHtvjLabel.setText("Mã khách hàng");

        suaBHtvjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        suaBHtvjButton.setForeground(new java.awt.Color(0, 102, 102));
        suaBHtvjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/edit bh.png"))); // NOI18N
        suaBHtvjButton.setText("SỬA");
        suaBHtvjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                suaBHtvjButtonActionPerformed(evt);
            }
        });

        ngayMuaBHTVjTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ngayMuaBHTVjTextFieldActionPerformed(evt);
            }
        });

        soLuongBHtvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        soLuongBHtvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        soLuongBHtvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/stats.png"))); // NOI18N
        soLuongBHtvjLabel.setText("Số lượng");

        soLuongBHtvjTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                soLuongBHtvjTextFieldActionPerformed(evt);
            }
        });

        maNhanVienBHtvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maNhanVienBHtvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maNhanVienBHtvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/employee.png"))); // NOI18N
        maNhanVienBHtvjLabel.setText("Mã nhân viên");

        maDonHangBHtvjTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                maDonHangBHtvjTextFieldActionPerformed(evt);
            }
        });

        huyBHtvjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        huyBHtvjButton.setForeground(new java.awt.Color(0, 102, 102));
        huyBHtvjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/x-buttonbh.png"))); // NOI18N
        huyBHtvjButton.setText("HỦY");
        huyBHtvjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                huyBHtvjButtonActionPerformed(evt);
            }
        });

        themBHtvjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        themBHtvjButton.setForeground(new java.awt.Color(0, 102, 102));
        themBHtvjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/plusbh.png"))); // NOI18N
        themBHtvjButton.setText("THÊM");
        themBHtvjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                themBHtvjButtonActionPerformed(evt);
            }
        });

        xoaBHtvjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        xoaBHtvjButton.setForeground(new java.awt.Color(0, 102, 102));
        xoaBHtvjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/databasebh.png"))); // NOI18N
        xoaBHtvjButton.setText("XÓA");
        xoaBHtvjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xoaBHtvjButtonActionPerformed(evt);
            }
        });

        sanPhamBHTVjTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "STT", "Mã sản phẩm", "Tên sản phẩm", "Số lượng", "Đơn giá", "Thành tiền"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        sanPhamBHTVjTable.getTableHeader().setReorderingAllowed(false);
        sanPhamBHTVjTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                sanPhamBHTVjTableMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(sanPhamBHTVjTable);
        if (sanPhamBHTVjTable.getColumnModel().getColumnCount() > 0) {
            sanPhamBHTVjTable.getColumnModel().getColumn(0).setResizable(false);
            sanPhamBHTVjTable.getColumnModel().getColumn(1).setResizable(false);
            sanPhamBHTVjTable.getColumnModel().getColumn(2).setResizable(false);
            sanPhamBHTVjTable.getColumnModel().getColumn(3).setResizable(false);
            sanPhamBHTVjTable.getColumnModel().getColumn(4).setResizable(false);
            sanPhamBHTVjTable.getColumnModel().getColumn(5).setResizable(false);
        }

        themSPBHTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        themSPBHTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        themSPBHTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/plusbh.png"))); // NOI18N
        themSPBHTVjButton.setText("THÊM");
        themSPBHTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                themSPBHTVjButtonActionPerformed(evt);
            }
        });

        ngayMuaBHtvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        ngayMuaBHtvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        ngayMuaBHtvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/weekly-calendar.png"))); // NOI18N
        ngayMuaBHtvjLabel.setText("Ngày mua");

        maNhanVienBHTVjTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                maNhanVienBHTVjTextFieldActionPerformed(evt);
            }
        });

        inHoaDonBHTVjButton.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        inHoaDonBHTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        inHoaDonBHTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/printer.png"))); // NOI18N
        inHoaDonBHTVjButton.setText("IN HÓA ĐƠN");
        inHoaDonBHTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                inHoaDonBHTVjButtonActionPerformed(evt);
            }
        });

        xemTatCaDonHangBHTVjButton.setText("XEM TẤT CẢ ĐƠN HÀNG");
        xemTatCaDonHangBHTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xemTatCaDonHangBHTVjButtonActionPerformed(evt);
            }
        });

        suaSPBHTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        suaSPBHTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        suaSPBHTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/edit bh.png"))); // NOI18N
        suaSPBHTVjButton.setText("SỬA");
        suaSPBHTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                suaSPBHTVjButtonActionPerformed(evt);
            }
        });

        xoaSPBHTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        xoaSPBHTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        xoaSPBHTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/databasebh.png"))); // NOI18N
        xoaSPBHTVjButton.setText("XÓA");
        xoaSPBHTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xoaSPBHTVjButtonActionPerformed(evt);
            }
        });

        locDonHangBHTVjButton.setText("LỌC");
        locDonHangBHTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                locDonHangBHTVjButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout thanhVienjPanelLayout = new javax.swing.GroupLayout(thanhVienjPanel);
        thanhVienjPanel.setLayout(thanhVienjPanelLayout);
        thanhVienjPanelLayout.setHorizontalGroup(
            thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addGap(28, 28, 28)
                        .addComponent(maSanPhamBHtvjLabel)
                        .addGap(78, 78, 78)
                        .addComponent(maSanPhamBHtvjComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 170, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(soLuongBHtvjLabel))
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addGap(53, 53, 53)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(maDonHangBHtvjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 151, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(maKhachHangBHtvjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 169, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(33, 33, 33)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(maDonHangBHtvjTextField)
                            .addComponent(maKhachHangBHTVjComboBox, 0, 287, Short.MAX_VALUE))))
                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addComponent(soLuongBHtvjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(52, 52, 52)
                        .addComponent(themSPBHTVjButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(suaSPBHTVjButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(xoaSPBHTVjButton)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                                .addComponent(themBHtvjButton)
                                .addGap(18, 18, 18)
                                .addComponent(suaBHtvjButton)
                                .addGap(18, 18, 18)
                                .addComponent(xoaBHtvjButton)
                                .addGap(18, 18, 18)
                                .addComponent(huyBHtvjButton)
                                .addContainerGap(713, Short.MAX_VALUE))
                            .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                                .addGap(105, 105, 105)
                                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(maNhanVienBHtvjLabel)
                                    .addComponent(ngayMuaBHtvjLabel))
                                .addGap(92, 92, 92)
                                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(maNhanVienBHTVjTextField, javax.swing.GroupLayout.DEFAULT_SIZE, 341, Short.MAX_VALUE)
                                    .addComponent(ngayMuaBHTVjTextField))
                                .addGap(0, 0, Short.MAX_VALUE))))))
            .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addComponent(xemTatCaDonHangBHTVjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(locDonHangBHTVjButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(inHoaDonBHTVjButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(xuatBHtvjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 1378, Short.MAX_VALUE)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.Alignment.LEADING))
                .addGap(401, 401, 401))
        );
        thanhVienjPanelLayout.setVerticalGroup(
            thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(maSanPhamBHtvjLabel)
                        .addComponent(maSanPhamBHtvjComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(soLuongBHtvjLabel)
                        .addComponent(soLuongBHtvjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(themSPBHTVjButton)
                        .addComponent(suaSPBHTVjButton)
                        .addComponent(xoaSPBHTVjButton)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 146, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(maDonHangBHtvjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(maDonHangBHtvjLabel))
                        .addGap(150, 150, 150))
                    .addGroup(thanhVienjPanelLayout.createSequentialGroup()
                        .addGap(27, 27, 27)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(maNhanVienBHtvjLabel)
                            .addComponent(maNhanVienBHTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(ngayMuaBHtvjLabel)
                                .addComponent(maKhachHangBHtvjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(maKhachHangBHTVjComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(ngayMuaBHTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(themBHtvjButton)
                            .addComponent(suaBHtvjButton)
                            .addComponent(xoaBHtvjButton)
                            .addComponent(huyBHtvjButton))
                        .addGap(12, 12, 12)))
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 324, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(thanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(xuatBHtvjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(inHoaDonBHTVjButton)
                    .addComponent(xemTatCaDonHangBHTVjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(locDonHangBHTVjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        jTabbedPane1.addTab("THÀNH VIÊN   ", new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/membership.png")), thanhVienjPanel); // NOI18N

        khongThanhVienjPanel.setBackground(new java.awt.Color(255, 255, 255));

        banHangKTVjTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã đơn hàng", "Tên khách hàng", "Địa chỉ", "Số điện thoại", "Mã sản phẩm", "Tên sản phẩm", "Đơn giá", "Số lượng", "Thành tiền", "Ngày mua", "Mã nhân viên"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, true, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        banHangKTVjTable.getTableHeader().setReorderingAllowed(false);
        banHangKTVjTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                banHangKTVjTableMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(banHangKTVjTable);
        if (banHangKTVjTable.getColumnModel().getColumnCount() > 0) {
            banHangKTVjTable.getColumnModel().getColumn(0).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(1).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(2).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(3).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(4).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(5).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(6).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(7).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(9).setResizable(false);
            banHangKTVjTable.getColumnModel().getColumn(10).setResizable(false);
        }

        maDonHangBHKTVjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maDonHangBHKTVjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maDonHangBHKTVjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/business-card-of-folded-diptych-design.png"))); // NOI18N
        maDonHangBHKTVjLabel.setText("Mã đơn hàng");

        hoTenBHKTVjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        hoTenBHKTVjLabel.setForeground(new java.awt.Color(0, 102, 102));
        hoTenBHKTVjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/dog-tag.png"))); // NOI18N
        hoTenBHKTVjLabel.setText("Họ tên");

        themBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        themBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        themBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/plusbh.png"))); // NOI18N
        themBHKTVjButton.setText("THÊM");
        themBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                themBHKTVjButtonActionPerformed(evt);
            }
        });

        huyBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        huyBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        huyBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/x-buttonbh.png"))); // NOI18N
        huyBHKTVjButton.setText("HỦY");
        huyBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                huyBHKTVjButtonActionPerformed(evt);
            }
        });

        soDienThoaiBHKTVjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        soDienThoaiBHKTVjLabel.setForeground(new java.awt.Color(0, 102, 102));
        soDienThoaiBHKTVjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/agenda.png"))); // NOI18N
        soDienThoaiBHKTVjLabel.setText("Số điện thoại");

        soLuongBHktvjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        soLuongBHktvjLabel.setForeground(new java.awt.Color(0, 102, 102));
        soLuongBHktvjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/stats.png"))); // NOI18N
        soLuongBHktvjLabel.setText("Số lượng");

        soLuongBHKTVjTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                soLuongBHKTVjTextFieldActionPerformed(evt);
            }
        });

        maSanPhamBHKTVjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maSanPhamBHKTVjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maSanPhamBHKTVjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/business-card-of-folded-diptych-design.png"))); // NOI18N
        maSanPhamBHKTVjLabel.setText("Mã sản phẩm");

        maSanPhamBHKTVjComboBox.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maSanPhamBHKTVjComboBox.setForeground(new java.awt.Color(0, 102, 102));
        maSanPhamBHKTVjComboBox.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                maSanPhamBHKTVjComboBoxActionPerformed(evt);
            }
        });

        maNhanVienBHKTVjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        maNhanVienBHKTVjLabel.setForeground(new java.awt.Color(0, 102, 102));
        maNhanVienBHKTVjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/employee.png"))); // NOI18N
        maNhanVienBHKTVjLabel.setText("Mã nhân viên");

        diaChiBHKTVjLabel.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        diaChiBHKTVjLabel.setForeground(new java.awt.Color(0, 102, 102));
        diaChiBHKTVjLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/notebook.png"))); // NOI18N
        diaChiBHKTVjLabel.setText("Địa chỉ");

        suaBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        suaBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        suaBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/edit bh.png"))); // NOI18N
        suaBHKTVjButton.setText("SỬA");
        suaBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                suaBHKTVjButtonActionPerformed(evt);
            }
        });

        xuatBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        xuatBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        xuatBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/share.png"))); // NOI18N
        xuatBHKTVjButton.setText("XUẤT");
        xuatBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xuatBHKTVjButtonActionPerformed(evt);
            }
        });

        xoaBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        xoaBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        xoaBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/databasebh.png"))); // NOI18N
        xoaBHKTVjButton.setText("XÓA");
        xoaBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xoaBHKTVjButtonActionPerformed(evt);
            }
        });

        sanPhamBHKTVjTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "STT", "Mã sản phẩm", "Tên sản phẩm", "Số lượng", "Đơn giá", "Thành tiền"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        sanPhamBHKTVjTable.getTableHeader().setReorderingAllowed(false);
        sanPhamBHKTVjTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                sanPhamBHKTVjTableMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(sanPhamBHKTVjTable);
        if (sanPhamBHKTVjTable.getColumnModel().getColumnCount() > 0) {
            sanPhamBHKTVjTable.getColumnModel().getColumn(0).setResizable(false);
            sanPhamBHKTVjTable.getColumnModel().getColumn(1).setResizable(false);
            sanPhamBHKTVjTable.getColumnModel().getColumn(2).setResizable(false);
            sanPhamBHKTVjTable.getColumnModel().getColumn(3).setResizable(false);
            sanPhamBHKTVjTable.getColumnModel().getColumn(4).setResizable(false);
            sanPhamBHKTVjTable.getColumnModel().getColumn(5).setResizable(false);
        }

        themSPBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        themSPBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        themSPBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/plusbh.png"))); // NOI18N
        themSPBHKTVjButton.setText("THÊM");
        themSPBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                themSPBHKTVjButtonActionPerformed(evt);
            }
        });

        ngayMuaBHtvjLabel1.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        ngayMuaBHtvjLabel1.setForeground(new java.awt.Color(0, 102, 102));
        ngayMuaBHtvjLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/weekly-calendar.png"))); // NOI18N
        ngayMuaBHtvjLabel1.setText("Ngày mua");

        ngayMuaBHKTVjTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ngayMuaBHKTVjTextFieldActionPerformed(evt);
            }
        });

        jLabel2.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel2.setText("*");

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel3.setText("*");

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel4.setText("* Các trường có dấu sao là bắt buộc");

        inHoaDonBHKTVjButton.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        inHoaDonBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        inHoaDonBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/printer.png"))); // NOI18N
        inHoaDonBHKTVjButton.setText("IN HÓA ĐƠN");
        inHoaDonBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                inHoaDonBHKTVjButtonActionPerformed(evt);
            }
        });

        suaSPBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        suaSPBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        suaSPBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/edit bh.png"))); // NOI18N
        suaSPBHKTVjButton.setText("SỬA");
        suaSPBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                suaSPBHKTVjButtonActionPerformed(evt);
            }
        });

        xoaSPBHKTVjButton.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        xoaSPBHKTVjButton.setForeground(new java.awt.Color(0, 102, 102));
        xoaSPBHKTVjButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/databasebh.png"))); // NOI18N
        xoaSPBHKTVjButton.setText("XÓA");
        xoaSPBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xoaSPBHKTVjButtonActionPerformed(evt);
            }
        });

        xemTatCaDonHangBHKTVjButton.setText("XEM TẤT CẢ ĐƠN HÀNG");
        xemTatCaDonHangBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xemTatCaDonHangBHKTVjButtonActionPerformed(evt);
            }
        });

        locDonHangBHKTVjButton.setText("LỌC");
        locDonHangBHKTVjButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                locDonHangBHKTVjButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout khongThanhVienjPanelLayout = new javax.swing.GroupLayout(khongThanhVienjPanel);
        khongThanhVienjPanel.setLayout(khongThanhVienjPanelLayout);
        khongThanhVienjPanelLayout.setHorizontalGroup(
            khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(maSanPhamBHKTVjLabel)
                .addGap(18, 18, 18)
                .addComponent(maSanPhamBHKTVjComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 252, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(33, 33, 33)
                .addComponent(soLuongBHktvjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(soLuongBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 134, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(themSPBHKTVjButton)
                .addGap(18, 18, 18)
                .addComponent(suaSPBHKTVjButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(xoaSPBHKTVjButton)
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, khongThanhVienjPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(xemTatCaDonHangBHKTVjButton)
                .addGap(18, 18, 18)
                .addComponent(locDonHangBHKTVjButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(inHoaDonBHKTVjButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(xuatBHKTVjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                        .addComponent(jScrollPane4)
                        .addContainerGap())
                    .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                        .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel4)
                            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, khongThanhVienjPanelLayout.createSequentialGroup()
                                        .addComponent(maDonHangBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(18, 18, 18)
                                        .addComponent(maDonHangBHKTVjTextField))
                                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, khongThanhVienjPanelLayout.createSequentialGroup()
                                        .addComponent(soDienThoaiBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(18, 18, 18)
                                        .addComponent(soDienThoaiBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 250, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                        .addGap(46, 46, 46)
                                        .addComponent(hoTenBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(18, 18, 18)
                                        .addComponent(hoTenBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 250, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(jLabel2))
                                    .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 18, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(18, 18, 18)
                                        .addComponent(maNhanVienBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(18, 18, 18)
                                        .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                                .addComponent(themBHKTVjButton)
                                                .addGap(18, 18, 18)
                                                .addComponent(suaBHKTVjButton))
                                            .addComponent(maNhanVienBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 250, javax.swing.GroupLayout.PREFERRED_SIZE))))))
                        .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                .addGap(31, 73, Short.MAX_VALUE)
                                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, khongThanhVienjPanelLayout.createSequentialGroup()
                                        .addComponent(diaChiBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                                    .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                        .addComponent(ngayMuaBHtvjLabel1)
                                        .addGap(47, 47, 47)))
                                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(ngayMuaBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 198, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(diaChiBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 201, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(14, 14, 14))
                            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(xoaBHKTVjButton)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(huyBHKTVjButton)
                                .addGap(0, 0, Short.MAX_VALUE))))))
            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2)
                .addContainerGap())
        );
        khongThanhVienjPanelLayout.setVerticalGroup(
            khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(khongThanhVienjPanelLayout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(maSanPhamBHKTVjComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(maSanPhamBHKTVjLabel)
                    .addComponent(soLuongBHktvjLabel)
                    .addComponent(soLuongBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(themSPBHKTVjButton)
                    .addComponent(suaSPBHKTVjButton)
                    .addComponent(xoaSPBHKTVjButton))
                .addGap(14, 14, 14)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 161, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(maDonHangBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(maDonHangBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(diaChiBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(hoTenBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(hoTenBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(diaChiBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2))
                .addGap(18, 18, 18)
                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(soDienThoaiBHKTVjLabel)
                    .addComponent(soDienThoaiBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3)
                    .addComponent(maNhanVienBHKTVjLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(maNhanVienBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ngayMuaBHtvjLabel1)
                    .addComponent(ngayMuaBHKTVjTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(themBHKTVjButton)
                    .addComponent(suaBHKTVjButton)
                    .addComponent(xoaBHKTVjButton)
                    .addComponent(huyBHKTVjButton)
                    .addComponent(jLabel4))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 302, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(khongThanhVienjPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(xuatBHKTVjButton, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(inHoaDonBHKTVjButton)
                    .addComponent(xemTatCaDonHangBHKTVjButton)
                    .addComponent(locDonHangBHKTVjButton))
                .addContainerGap())
        );

        jTabbedPane1.addTab("KHÔNG THÀNH VIÊN   ", new javax.swing.ImageIcon(getClass().getResource("/com/qlbh/images/no-disturb-symbol-in-a-circle.png")), khongThanhVienjPanel); // NOI18N

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1402, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 1, Short.MAX_VALUE)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(40, 40, 40)
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 855, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents

    public void loadMaKhachHang(String maKH) {
        if (maKH.equals("")) {
            maKhachHangBHTVjComboBox.addItem("");
        }

        listKhachHang = KhachHangDAO.getListKhachHang();
        for (int i = 0; i < listKhachHang.size(); i++) {

            if (listKhachHang.get(i).getMaKhachHang().equals(maKH)) {
            } else {
                maKhachHangBHTVjComboBox.addItem(listKhachHang.get(i).getMaKhachHang());
            }

        }
    }

    public void loadMaSanPham() {
        listSanPham = SanPhamDAO.getListSanPham();
        maSanPhamBHtvjComboBox.addItem("");
        for (int i = 0; i < listSanPham.size(); i++) {
            maSanPhamBHtvjComboBox.addItem(listSanPham.get(i).getMaSanPham());
        }
    }

    public void loadBanHangThanhVien() {
        thanhVienDefaultTableModel.setRowCount(0);
        listHoaDon = HoaDonDAO.getListHoaDon();
        for (int i = 0; i < listHoaDon.size(); i++) {
            if (!(listHoaDon.get(i).getMaKhachHangMua() == null)) {
                KhachHang khachHang = KhachHangDAO.getMotKhachHang(listHoaDon.get(i).getMaKhachHangMua());
                ArrayList<ChiTietHoaDon> listChiTietMotHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(listHoaDon.get(i).getMaHoaDon());
                for (int j = 0; j < listChiTietMotHoaDon.size(); j++) {
                    SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietMotHoaDon.get(j).getMaSanPhamMua());
                    thanhVienDefaultTableModel.addRow(new Object[]{
                        listHoaDon.get(i).getMaHoaDon(),
                        khachHang.getMaKhachHang(),
                        khachHang.getTenKhachHang(),
                        listChiTietMotHoaDon.get(j).getMaSanPhamMua(),
                        sanPham.getTenSanPham(),
                        format.format(listChiTietMotHoaDon.get(j).getGiaSanPhamMua()),
                        listChiTietMotHoaDon.get(j).getSoLuongMua(),
                        format.format(listChiTietMotHoaDon.get(j).tinhTien()),
                        listHoaDon.get(i).getNgayMua(),
                        listHoaDon.get(i).getMaNhanVienBan()
                    });
                }
            }

        }
    }

    public void loadBanHangKhongThanhVien() {
        koThanhVienDefaultTableModel.setRowCount(0);
        listHoaDon = HoaDonDAO.getListHoaDon();
        for (int i = 0; i < listHoaDon.size(); i++) {
            if (listHoaDon.get(i).getMaKhachHangMua() == null) {
                ArrayList<ChiTietHoaDon> listChiTietMotHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(listHoaDon.get(i).getMaHoaDon());
                for (int j = 0; j < listChiTietMotHoaDon.size(); j++) {
                    SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietMotHoaDon.get(j).getMaSanPhamMua());
                    koThanhVienDefaultTableModel.addRow(new Object[]{
                        listHoaDon.get(i).getMaHoaDon(),
                        listHoaDon.get(i).getTenKhachHangMua(),
                        listHoaDon.get(i).getDiaChiKhachHangMua(),
                        listHoaDon.get(i).getSoDienThoaiKH(),
                        listChiTietMotHoaDon.get(j).getMaSanPhamMua(),
                        sanPham.getTenSanPham(),
                        format.format(listChiTietMotHoaDon.get(j).getGiaSanPhamMua()),
                        listChiTietMotHoaDon.get(j).getSoLuongMua(),
                        format.format(listChiTietMotHoaDon.get(j).tinhTien()),
                        listHoaDon.get(i).getNgayMua(),
                        listHoaDon.get(i).getMaNhanVienBan()
                    });

                }
            }

        }
    }

    public void loadMaSanPhamBHKTV() {
        maSanPhamBHKTVjComboBox.addItem("");
        for (int i = 0; i < listSanPham.size(); i++) {
            maSanPhamBHKTVjComboBox.addItem(listSanPham.get(i).getMaSanPham());
        }
    }


    private void soLuongBHKTVjTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_soLuongBHKTVjTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_soLuongBHKTVjTextFieldActionPerformed

    private void maSanPhamBHKTVjComboBoxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_maSanPhamBHKTVjComboBoxActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_maSanPhamBHKTVjComboBoxActionPerformed

    private void maDonHangBHtvjTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_maDonHangBHtvjTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_maDonHangBHtvjTextFieldActionPerformed

    private void soLuongBHtvjTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_soLuongBHtvjTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_soLuongBHtvjTextFieldActionPerformed

    private void ngayMuaBHTVjTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ngayMuaBHTVjTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ngayMuaBHTVjTextFieldActionPerformed

    private void maSanPhamBHtvjComboBoxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_maSanPhamBHtvjComboBoxActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_maSanPhamBHtvjComboBoxActionPerformed

    private void themBHtvjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_themBHtvjButtonActionPerformed
        // TODO add your handling code here:
        try {

            int count = sanPhamThanhVienDefaultTableModel.getRowCount();
            if (count == 0) {
                JOptionPane.showMessageDialog(null, "Vui lòng thêm sản phẩm", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            } else {
                String maKhachHang = maKhachHangBHTVjComboBox.getSelectedItem().toString();
                String maNhanVien = maNhanVienBHTVjTextField.getText();
                long maHoaDon = new Date().getTime();

                if (maKhachHang.equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng nhập đầy đủ thông tin", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                } else {
                    HoaDon hoaDon = new HoaDon();
                    hoaDon.setMaHoaDon(maHoaDon);
                    hoaDon.setMaKhachHangMua(maKhachHang);
                    KhachHang khachHang = KhachHangDAO.getMotKhachHang(maKhachHang);
                    hoaDon.setNgayMua(new Timestamp(new Date().getTime()));
                    hoaDon.setMaNhanVienBan(maNhanVien);
                    if (HoaDonDAO.themHoaDon(hoaDon)) {
                        ArrayList<SanPham> listSanPhamMua = new ArrayList<>();
                        for (int i = 0; i < sanPhamThanhVienDefaultTableModel.getRowCount(); i++) {
                            SanPham sanPhamMua = new SanPham();
                            sanPhamMua.setMaSanPham(sanPhamThanhVienDefaultTableModel.getValueAt(i, 1).toString());
                            sanPhamMua.setTenSanPham(sanPhamThanhVienDefaultTableModel.getValueAt(i, 2).toString());
                            sanPhamMua.setSoLuong(Integer.parseInt(sanPhamThanhVienDefaultTableModel.getValueAt(i, 3).toString()));
                            sanPhamMua.setDonGia(Double.parseDouble(sanPhamThanhVienDefaultTableModel.getValueAt(i, 4).toString()));
                            listSanPhamMua.add(sanPhamMua);
                        }
                        //ArrayList<ChiTietHoaDon> listChiTietHoaDon = new ArrayList<>();
                        for (int i = 0; i < listSanPhamMua.size(); i++) {
                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                            chiTietHoaDon.setMaSanPhamMua(listSanPhamMua.get(i).getMaSanPham());
                            chiTietHoaDon.setSoLuongMua(listSanPhamMua.get(i).getSoLuong());
                            SanPham sanPham = SanPhamDAO.getMotSanPham(listSanPhamMua.get(i).getMaSanPham());
                            chiTietHoaDon.setGiaSanPhamMua(listSanPhamMua.get(i).getDonGia());
                            ChiTietHoaDonDAO.themChiTietHoaDon(chiTietHoaDon);
                            SanPham sanPhamCapNhapSoLuong = SanPhamDAO.getMotSanPham(listSanPhamMua.get(i).getMaSanPham());
                            SanPhamDAO.capNhapSoLuongSanPham(listSanPhamMua.get(i).getMaSanPham(), sanPhamCapNhapSoLuong.getSoLuong() - listSanPhamMua.get(i).getSoLuong());
                            //listChiTietHoaDon.add(chiTietHoaDon);
                            // thêm db xong phải thêm vô cột
                            thanhVienDefaultTableModel.addRow(new Object[]{
                                maHoaDon,
                                maKhachHang,
                                khachHang.getTenKhachHang(),
                                chiTietHoaDon.getMaSanPhamMua(),
                                sanPham.getTenSanPham(),
                                format.format(chiTietHoaDon.getGiaSanPhamMua()),
                                chiTietHoaDon.getSoLuongMua(),
                                format.format(chiTietHoaDon.tinhTien()),
                                hoaDon.getNgayMua(),
                                hoaDon.getMaNhanVienBan()
                            });

                        }
                        sanPhamThanhVienDefaultTableModel.setRowCount(0);
                        maKhachHangBHTVjComboBox.removeAllItems();
                        loadMaKhachHang("");
                        JOptionPane.showMessageDialog(null, "Đã thêm", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                    }

                }
            }

        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Kiểm tra giá trị nhập vào", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
        }

    }//GEN-LAST:event_themBHtvjButtonActionPerformed

    private void maNhanVienBHTVjTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_maNhanVienBHTVjTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_maNhanVienBHTVjTextFieldActionPerformed

    public boolean kiemTraTrungLapMaSanPham(DefaultTableModel tableModel, JTable jTable, String maSanPhamKiemTra) {
        tableModel = (DefaultTableModel) jTable.getModel();
        for (int i = 0; i < tableModel.getRowCount(); i++) {
            if (tableModel.getValueAt(i, 1).toString().equals(maSanPhamKiemTra)) {
                return true;
            }
        }
        return false;
    }


    private void themSPBHTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_themSPBHTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int kiemTra = banhangTVjTable.getSelectedRow();
            if (kiemTra != -1) { // thêm sản phẩm mới khi hóa đơn đã tồn tại
                String maSanPham = maSanPhamBHtvjComboBox.getSelectedItem().toString();
                int soLuong = Integer.parseInt(soLuongBHtvjTextField.getText());
                if (maSanPham.equals("") || String.valueOf(soLuong).equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng điền đầy đủ thông tin!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                } else {
                    if (kiemTraTrungLapMaSanPham(sanPhamThanhVienDefaultTableModel, sanPhamBHTVjTable, maSanPham)) {
                        JOptionPane.showMessageDialog(null, "Trùng lặp mã sản phẩm, vui lòng nhập lại!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                        //sanPhamThanhVienDefaultTableModel.setRowCount(0);
                    } else {
                        if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                            maSanPhamBHtvjComboBox.removeAllItems();
                            loadMaSanPham();
                            soLuongBHtvjTextField.setText("");
                            sanPhamThanhVienDefaultTableModel.addRow(new Object[]{
                                sanPhamThanhVienDefaultTableModel.getRowCount() + 1, maSanPham, sanPham.getTenSanPham(), soLuong, format2.format(sanPham.getDonGia()), format.format(sanPham.getDonGia() * soLuong)
                            });
//                            long maHoaDon = Long.parseLong(maDonHangBHtvjTextField.getText());
//                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
//                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
//                            chiTietHoaDon.setMaSanPhamMua(maSanPham);
//                            chiTietHoaDon.setGiaSanPhamMua(sanPham.getDonGia());
//                            chiTietHoaDon.setSoLuongMua(soLuong);
//                            if (ChiTietHoaDonDAO.themChiTietHoaDon(chiTietHoaDon)) {
//                                SanPhamDAO.capNhapSoLuongSanPham(maSanPham, sanPham.getSoLuong() - soLuong);
////                                thanhVienDefaultTableModel.setRowCount(0);
////                                loadBanHang();
//                                loadBanHangThanhVienMotHoaDon(maHoaDon);
//
//                                JOptionPane.showMessageDialog(null, "Đã thêm sản phẩm!", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
//                                setMacDinhBHTV();
//                            } else {
//                                JOptionPane.showMessageDialog(null, "Có lỗi xảy ra, thử lại sau!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
//
//                            }

                        } else {
                            JOptionPane.showMessageDialog(null, "Sản phẩm không đủ số lượng!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                        }
                    }
                }
            } else {
                String maSanPham = maSanPhamBHtvjComboBox.getSelectedItem().toString();
                int soLuong = Integer.parseInt(soLuongBHtvjTextField.getText());
                if (maSanPham.equals("") || String.valueOf(soLuong).equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng nhập đầy đủ thông tin!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                } else {
                    if (kiemTraTrungLapMaSanPham(sanPhamThanhVienDefaultTableModel, sanPhamBHTVjTable, maSanPham)) {
                        JOptionPane.showMessageDialog(null, "Trùng lặp mã sản phẩm, vui lòng nhập lại!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                        sanPhamThanhVienDefaultTableModel.setRowCount(0);
                    } else {
                        if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                            maSanPhamBHtvjComboBox.removeAllItems();
                            loadMaSanPham();
                            soLuongBHtvjTextField.setText("");
                            sanPhamThanhVienDefaultTableModel.addRow(new Object[]{
                                sanPhamThanhVienDefaultTableModel.getRowCount() + 1, maSanPham, sanPham.getTenSanPham(), soLuong, format2.format(sanPham.getDonGia()), format.format(sanPham.getDonGia() * soLuong)
                            });
                        } else {
                            JOptionPane.showMessageDialog(null, "Sản phẩm không đủ số lượng!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                        }
                    }
                }

            }

        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Kiểm tra giá trị nhập vào", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

        }
    }//GEN-LAST:event_themSPBHTVjButtonActionPerformed

    private void banhangTVjTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_banhangTVjTableMouseClicked
        // TODO add your handling code here:
        try {
            huyBHtvjButton.setEnabled(true);
            themBHtvjButton.setEnabled(false);
            sanPhamThanhVienDefaultTableModel.setRowCount(0);
            int row = banhangTVjTable.getSelectedRow();
            maDonHangBHtvjTextField.setText(thanhVienDefaultTableModel.getValueAt(row, 0).toString());
            ngayMuaBHTVjTextField.setText(thanhVienDefaultTableModel.getValueAt(row, 8).toString());
            soLuongBHtvjTextField.setText(thanhVienDefaultTableModel.getValueAt(row, 6).toString());
            maKhachHangBHTVjComboBox.removeAllItems();
            maKhachHangBHTVjComboBox.addItem(thanhVienDefaultTableModel.getValueAt(row, 1).toString());
            loadMaKhachHang(thanhVienDefaultTableModel.getValueAt(row, 1).toString());

            maSanPhamBHtvjComboBox.removeAllItems();
            maSanPhamBHtvjComboBox.addItem(thanhVienDefaultTableModel.getValueAt(row, 3).toString());
            ArrayList<ChiTietHoaDon> listChiTietHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(Long.parseLong(thanhVienDefaultTableModel.getValueAt(row, 0).toString()));
            for (int i = 0; i < listChiTietHoaDon.size(); i++) {
                SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietHoaDon.get(i).getMaSanPhamMua());
                sanPhamThanhVienDefaultTableModel.addRow(new Object[]{
                    i + 1,
                    listChiTietHoaDon.get(i).getMaSanPhamMua(),
                    sanPham.getTenSanPham(),
                    listChiTietHoaDon.get(i).getSoLuongMua(),
                    format2.format(listChiTietHoaDon.get(i).getGiaSanPhamMua()),
                    format2.format(listChiTietHoaDon.get(i).tinhTien()),});
            }

            listSanPham = SanPhamDAO.getListSanPham();
            for (int i = 0; i < listSanPham.size(); i++) {
                if (listSanPham.get(i).getMaSanPham().equals(thanhVienDefaultTableModel.getValueAt(row, 3).toString())) {
                } else {
                    maSanPhamBHtvjComboBox.addItem(listSanPham.get(i).getMaSanPham());

                }
            }

        } catch (Exception e) {
        }
    }//GEN-LAST:event_banhangTVjTableMouseClicked

    private void sanPhamBHTVjTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_sanPhamBHTVjTableMouseClicked
        // TODO add your handling code here:
        try {
            int row = sanPhamBHTVjTable.getSelectedRow();
            maSanPhamBHtvjComboBox.removeAllItems();
            maSanPhamBHtvjComboBox.addItem(sanPhamThanhVienDefaultTableModel.getValueAt(row, 1).toString());
            listSanPham = SanPhamDAO.getListSanPham();
            for (int i = 0; i < listSanPham.size(); i++) {
                if (listSanPham.get(i).getMaSanPham().equals(sanPhamThanhVienDefaultTableModel.getValueAt(row, 3).toString())) {
                } else {
                    maSanPhamBHtvjComboBox.addItem(listSanPham.get(i).getMaSanPham());
                }
            }
            soLuongBHtvjTextField.setText(sanPhamThanhVienDefaultTableModel.getValueAt(row, 3).toString());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_sanPhamBHTVjTableMouseClicked

    public void loadBanHangThanhVienMotHoaDon(Long maHoaDon) {
        thanhVienDefaultTableModel.setRowCount(0);
        HoaDon hoaDon = HoaDonDAO.getHoaDon(maHoaDon);
        ArrayList<ChiTietHoaDon> listChiTietMotHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(maHoaDon);
        KhachHang khachHang = KhachHangDAO.getMotKhachHang(hoaDon.getMaKhachHangMua());
        for (int j = 0; j < listChiTietMotHoaDon.size(); j++) {
            SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietMotHoaDon.get(j).getMaSanPhamMua());
            thanhVienDefaultTableModel.addRow(new Object[]{
                maHoaDon,
                khachHang.getMaKhachHang(),
                khachHang.getTenKhachHang(),
                listChiTietMotHoaDon.get(j).getMaSanPhamMua(),
                sanPham.getTenSanPham(),
                format.format(listChiTietMotHoaDon.get(j).getGiaSanPhamMua()),
                listChiTietMotHoaDon.get(j).getSoLuongMua(),
                format.format(listChiTietMotHoaDon.get(j).tinhTien()),
                hoaDon.getNgayMua(),
                hoaDon.getMaNhanVienBan()
            });

        }
    }

    public void loadBanHangKhongThanhVienMotHoaDon(Long maHoaDon) {
        koThanhVienDefaultTableModel.setRowCount(0);
        HoaDon hoaDon = HoaDonDAO.getHoaDon(maHoaDon);
        ArrayList<ChiTietHoaDon> listChiTietMotHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(maHoaDon);
        for (int j = 0; j < listChiTietMotHoaDon.size(); j++) {
            SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietMotHoaDon.get(j).getMaSanPhamMua());
            koThanhVienDefaultTableModel.addRow(new Object[]{
                maHoaDon,
                hoaDon.getTenKhachHangMua(),
                hoaDon.getDiaChiKhachHangMua(),
                hoaDon.getSoDienThoaiKH(),
                listChiTietMotHoaDon.get(j).getMaSanPhamMua(),
                sanPham.getTenSanPham(),
                format.format(listChiTietMotHoaDon.get(j).getGiaSanPhamMua()),
                listChiTietMotHoaDon.get(j).getSoLuongMua(),
                format.format(listChiTietMotHoaDon.get(j).tinhTien()),
                hoaDon.getNgayMua(),
                hoaDon.getMaNhanVienBan()
            });

        }
    }

    private void suaBHtvjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_suaBHtvjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = banhangTVjTable.getSelectedRow();
            if (row != -1) {
                long maHoaDon = Long.parseLong(maDonHangBHtvjTextField.getText());

                ArrayList<ChiTietHoaDon> listChiTietHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(maHoaDon);

                ArrayList<SanPham> listSanPhamMua = new ArrayList<>();
                for (int i = 0; i < sanPhamThanhVienDefaultTableModel.getRowCount(); i++) {
                    SanPham sanPhamMua = new SanPham();
                    sanPhamMua.setMaSanPham(sanPhamThanhVienDefaultTableModel.getValueAt(i, 1).toString());
                    sanPhamMua.setTenSanPham(sanPhamThanhVienDefaultTableModel.getValueAt(i, 2).toString());
                    sanPhamMua.setSoLuong(Integer.parseInt(sanPhamThanhVienDefaultTableModel.getValueAt(i, 3).toString()));
                    sanPhamMua.setDonGia(Double.parseDouble(sanPhamThanhVienDefaultTableModel.getValueAt(i, 4).toString()));
                    listSanPhamMua.add(sanPhamMua);
                }

                for (int i = 0; i < listChiTietHoaDon.size(); i++) {

                    int soLuongMoi = listSanPhamMua.get(i).getSoLuong();
                    int soLuongCu = listChiTietHoaDon.get(i).getSoLuongMua();

                    String maSanPhamMoi = listSanPhamMua.get(i).getMaSanPham();
                    String maSanPhamCu = listChiTietHoaDon.get(i).getMaSanPhamMua();

                    String maKhachHangCu = thanhVienDefaultTableModel.getValueAt(row, 1).toString();
                    String maKhachHangMoi = maKhachHangBHTVjComboBox.getSelectedItem().toString();
                    if (maSanPhamCu.equals(maSanPhamMoi)) {

                        if (soLuongMoi > soLuongCu) {
                            int chenhLech = soLuongMoi - soLuongCu;
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPhamCu);
                            SanPhamDAO.capNhapSoLuongSanPham(maSanPhamMoi, sanPham.getSoLuong() - chenhLech);

                        } else if (soLuongMoi < soLuongCu) {
                            int chenhLech = soLuongCu - soLuongMoi;
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPhamCu);
                            SanPhamDAO.capNhapSoLuongSanPham(maSanPhamMoi, sanPham.getSoLuong() + chenhLech);
                            if (soLuongMoi == 0) {
                                ChiTietHoaDonDAO.xoaMotChiTietHoaDon(maHoaDon, maSanPhamCu);
                            }
                        }
                        ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                        chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                        chiTietHoaDon.setMaSanPhamMua(maSanPhamMoi);
                        SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPhamMoi);
                        chiTietHoaDon.setGiaSanPhamMua(sanPham.getDonGia());
                        chiTietHoaDon.setSoLuongMua(soLuongMoi);
                        ChiTietHoaDonDAO.capNhapMotChiTietHoaDon(maHoaDon, chiTietHoaDon, maSanPhamCu);

                        if (!maKhachHangMoi.equals(maKhachHangCu)) {
                            HoaDonDAO.suaKhachHangHoaDon(maKhachHangMoi, maHoaDon);
                            thanhVienDefaultTableModel.setValueAt(maKhachHangMoi, row, 1);
                        }

                    } else {
                        SanPham sanPhamCu = SanPhamDAO.getMotSanPham(maSanPhamCu);
                        SanPhamDAO.capNhapSoLuongSanPham(maSanPhamCu, sanPhamCu.getSoLuong() + soLuongCu);
                        SanPham sanPhamMoi = SanPhamDAO.getMotSanPham(maSanPhamMoi);
                        SanPhamDAO.capNhapSoLuongSanPham(maSanPhamMoi, sanPhamMoi.getSoLuong() - soLuongMoi);

                        ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                        chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                        chiTietHoaDon.setMaSanPhamMua(maSanPhamMoi);
                        chiTietHoaDon.setGiaSanPhamMua(sanPhamMoi.getDonGia());
                        chiTietHoaDon.setSoLuongMua(soLuongMoi);
                        ChiTietHoaDonDAO.capNhapMotChiTietHoaDon(maHoaDon, chiTietHoaDon, maSanPhamCu);

                        if (!maKhachHangMoi.equals(maKhachHangCu)) {
                            HoaDonDAO.suaKhachHangHoaDon(maKhachHangMoi, maHoaDon);
                            thanhVienDefaultTableModel.setValueAt(maKhachHangMoi, row, 1);
                        }

                    }

                }

                int demSoLuongSanPhamMoi = sanPhamThanhVienDefaultTableModel.getRowCount();
                if (demSoLuongSanPhamMoi > listChiTietHoaDon.size()) {

                    ArrayList<SanPham> listSanPhamMoi = new ArrayList<>();
                    for (int i = listChiTietHoaDon.size(); i < demSoLuongSanPhamMoi; i++) {
                        SanPham sanPhamMua = new SanPham();
                        sanPhamMua.setMaSanPham(sanPhamThanhVienDefaultTableModel.getValueAt(i, 1).toString());
                        sanPhamMua.setTenSanPham(sanPhamThanhVienDefaultTableModel.getValueAt(i, 2).toString());
                        sanPhamMua.setSoLuong(Integer.parseInt(sanPhamThanhVienDefaultTableModel.getValueAt(i, 3).toString()));
                        sanPhamMua.setDonGia(Double.parseDouble(sanPhamThanhVienDefaultTableModel.getValueAt(i, 4).toString()));
                        listSanPhamMoi.add(sanPhamMua);
                    }
                    for (int i = 0; i < listSanPhamMoi.size(); i++) {
                        ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                        chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                        chiTietHoaDon.setMaSanPhamMua(listSanPhamMoi.get(i).getMaSanPham());
                        chiTietHoaDon.setSoLuongMua(listSanPhamMoi.get(i).getSoLuong());
                        chiTietHoaDon.setGiaSanPhamMua(listSanPhamMoi.get(i).getDonGia());
                        ChiTietHoaDonDAO.themChiTietHoaDon(chiTietHoaDon);
                        SanPham sanPhamCapNhapSoLuong = SanPhamDAO.getMotSanPham(listSanPhamMoi.get(i).getMaSanPham());
                        SanPhamDAO.capNhapSoLuongSanPham(listSanPhamMoi.get(i).getMaSanPham(), sanPhamCapNhapSoLuong.getSoLuong() - listSanPhamMoi.get(i).getSoLuong());

                    }

                }

                loadBanHangThanhVienMotHoaDon(maHoaDon);
                JOptionPane.showMessageDialog(null, "Đã sửa", "Message", JOptionPane.INFORMATION_MESSAGE, dung);

            } else {
                JOptionPane.showMessageDialog(null, "Chọn một đơn hàng để sửa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        sanPhamThanhVienDefaultTableModel.setRowCount(0);
        soLuongBHtvjTextField.setText("");
        maSanPhamBHtvjComboBox.removeAllItems();
        maKhachHangBHTVjComboBox.removeAllItems();
        loadMaSanPham();
        maDonHangBHtvjTextField.setText("");
        ngayMuaBHTVjTextField.setText("");
        loadMaKhachHang("");
        huyBHtvjButton.setEnabled(false);
        themBHtvjButton.setEnabled(true);
        themSPBHTVjButton.setEnabled(true);
    }//GEN-LAST:event_suaBHtvjButtonActionPerformed

    private void xoaBHtvjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xoaBHtvjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = banhangTVjTable.getSelectedRow();
            if (row != -1) {
                long maHoaDon = Long.parseLong(maDonHangBHtvjTextField.getText());
                int luaChon = JOptionPane.showConfirmDialog(null, "Bạn có chắn chắn muốn xóa không", "Message", JOptionPane.YES_NO_OPTION);
                if (luaChon == JOptionPane.YES_OPTION) {
                    if (HoaDonDAO.xoaHoaDon(maHoaDon)) {
//                        thanhVienDefaultTableModel.setRowCount(0);
//                        loadBanHang();
                        thanhVienDefaultTableModel.setRowCount(0);
                        JOptionPane.showMessageDialog(null, "Đã xóa", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                    } else {
                        JOptionPane.showMessageDialog(null, "Xãy ra lỗi, vui lòng thử lại sau", "Message", JOptionPane.INFORMATION_MESSAGE, dung);

                    }
                } else if (luaChon == JOptionPane.NO_OPTION) {

                    JOptionPane.showMessageDialog(null, "Đã hủy việc xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                }

            } else {
                JOptionPane.showMessageDialog(null, "Vui lòng chọn đơn hàng để xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }
        } catch (Exception e) {
        }
        sanPhamThanhVienDefaultTableModel.setRowCount(0);
        soLuongBHtvjTextField.setText("");

        maSanPhamBHtvjComboBox.removeAllItems();
        maKhachHangBHTVjComboBox.removeAllItems();

        loadMaSanPham();
        maDonHangBHtvjTextField.setText("");
        ngayMuaBHTVjTextField.setText("");

        loadMaKhachHang("");
        huyBHtvjButton.setEnabled(false);
        themBHtvjButton.setEnabled(true);
        themSPBHTVjButton.setEnabled(true);


    }//GEN-LAST:event_xoaBHtvjButtonActionPerformed

    public void setMacDinhBHTV() {
        sanPhamThanhVienDefaultTableModel.setRowCount(0);
        soLuongBHtvjTextField.setText("");
        maSanPhamBHtvjComboBox.removeAllItems();
        maKhachHangBHTVjComboBox.removeAllItems();
        loadMaSanPham();
        maDonHangBHtvjTextField.setText("");
        ngayMuaBHTVjTextField.setText("");
        loadMaKhachHang("");
        huyBHtvjButton.setEnabled(false);
        themBHtvjButton.setEnabled(true);
        themSPBHTVjButton.setEnabled(true);
        thanhVienDefaultTableModel.setRowCount(0);
        banhangTVjTable.clearSelection();

    }

    private void huyBHtvjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_huyBHtvjButtonActionPerformed
        // TODO add your handling code here:
        setMacDinhBHTV();
    }//GEN-LAST:event_huyBHtvjButtonActionPerformed

    private void themSPBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_themSPBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int kiemTra = banHangKTVjTable.getSelectedRow();
            if (kiemTra != -1) {

                String maSanPham = maSanPhamBHKTVjComboBox.getSelectedItem().toString();
                int soLuong = Integer.parseInt(soLuongBHKTVjTextField.getText());
                if (maSanPham.equals("") || String.valueOf(soLuong).equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng nhập đầy đủ thông tin!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                } else {
                    if (kiemTraTrungLapMaSanPham(sanPhamKhongThanhVienDefaultTableModel, sanPhamBHKTVjTable, maSanPham)) {
                        JOptionPane.showMessageDialog(null, "Trùng lặp mã sản phẩm, vui lòng nhập lại!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                        //sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
                    } else {
                        if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                            maSanPhamBHKTVjComboBox.removeAllItems();
                            loadMaSanPhamBHKTV();
                            soLuongBHKTVjTextField.setText("");
                            sanPhamKhongThanhVienDefaultTableModel.addRow(new Object[]{
                                sanPhamKhongThanhVienDefaultTableModel.getRowCount() + 1, maSanPham, sanPham.getTenSanPham(), soLuong, format2.format(sanPham.getDonGia()), format.format(sanPham.getDonGia() * soLuong)
                            });

//                            long maHoaDon = Long.parseLong(maDonHangBHKTVjTextField.getText());
//                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
//                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
//                            chiTietHoaDon.setMaSanPhamMua(maSanPham);
//                            chiTietHoaDon.setGiaSanPhamMua(sanPham.getDonGia());
//                            chiTietHoaDon.setSoLuongMua(soLuong);
//                            if (ChiTietHoaDonDAO.themChiTietHoaDon(chiTietHoaDon)) {
//                                SanPhamDAO.capNhapSoLuongSanPham(maSanPham, sanPham.getSoLuong() - soLuong);
//                                koThanhVienDefaultTableModel.setRowCount(0);
//                                loadBanHang();
//                                JOptionPane.showMessageDialog(null, "Đã thêm sản phẩm!", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
//                                setMacDinhBHKTV();
//                            } else {
//                                JOptionPane.showMessageDialog(null, "Có lỗi xảy ra, thử lại sau!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
//
//                            }
                        } else {
                            JOptionPane.showMessageDialog(null, "Sản phẩm không đủ số lượng!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                        }
                    }
                }
            } else {

                String maSanPham = maSanPhamBHKTVjComboBox.getSelectedItem().toString();
                int soLuong = Integer.parseInt(soLuongBHKTVjTextField.getText());
                if (maSanPham.equals("") || String.valueOf(soLuong).equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng nhập đầy đủ thông tin!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                } else {
                    if (kiemTraTrungLapMaSanPham(sanPhamKhongThanhVienDefaultTableModel, sanPhamBHKTVjTable, maSanPham)) {
                        JOptionPane.showMessageDialog(null, "Trùng lặp mã sản phẩm, vui lòng nhập lại!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                        sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
                    } else {
                        if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                            maSanPhamBHKTVjComboBox.removeAllItems();
                            loadMaSanPhamBHKTV();
                            soLuongBHKTVjTextField.setText("");
                            sanPhamKhongThanhVienDefaultTableModel.addRow(new Object[]{
                                sanPhamKhongThanhVienDefaultTableModel.getRowCount() + 1, maSanPham, sanPham.getTenSanPham(), soLuong, format2.format(sanPham.getDonGia()), format.format(sanPham.getDonGia() * soLuong)
                            });
                        } else {
                            JOptionPane.showMessageDialog(null, "Sản phẩm không đủ số lượng!", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                        }
                    }
                }
            }

        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Kiểm tra giá trị nhập vào", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

        }
    }//GEN-LAST:event_themSPBHKTVjButtonActionPerformed

    private void ngayMuaBHKTVjTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ngayMuaBHKTVjTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ngayMuaBHKTVjTextFieldActionPerformed

    private void themBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_themBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        try {

            int count = sanPhamKhongThanhVienDefaultTableModel.getRowCount();
            if (count == 0) {
                JOptionPane.showMessageDialog(null, "Vui lòng thêm sản phẩm ", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            } else {
                String tenKhachHang = hoTenBHKTVjTextField.getText();
                String soDienThoaiKH = soDienThoaiBHKTVjTextField.getText();
                String diaChiKhachHang = diaChiBHKTVjTextField.getText();
                String maNhanVien = maNhanVienBHKTVjTextField.getText();
                long maHoaDon = new Date().getTime();

                if (tenKhachHang.equals("") || soDienThoaiKH.equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng nhập đầy đủ thông tin", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                } else {
                    HoaDon hoaDon = new HoaDon();
                    hoaDon.setMaHoaDon(maHoaDon);
                    hoaDon.setTenKhachHangMua(tenKhachHang);
                    hoaDon.setDiaChiKhachHangMua(diaChiKhachHang);
                    hoaDon.setSoDienThoaiKH(soDienThoaiKH);
                    hoaDon.setNgayMua(new Timestamp(new Date().getTime()));
                    hoaDon.setMaNhanVienBan(maNhanVien);
                    if (HoaDonDAO.themHoaDon(hoaDon)) {
                        ArrayList<SanPham> listSanPhamMua = new ArrayList<>();
                        for (int i = 0; i < sanPhamKhongThanhVienDefaultTableModel.getRowCount(); i++) {
                            SanPham sanPhamMua = new SanPham();
                            sanPhamMua.setMaSanPham(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 1).toString());
                            sanPhamMua.setTenSanPham(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 2).toString());
                            sanPhamMua.setSoLuong(Integer.parseInt(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 3).toString()));
                            sanPhamMua.setDonGia(Double.parseDouble(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 4).toString()));
                            listSanPhamMua.add(sanPhamMua);
                        }
                        //ArrayList<ChiTietHoaDon> listChiTietHoaDon = new ArrayList<>();
                        for (int i = 0; i < listSanPhamMua.size(); i++) {
                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                            chiTietHoaDon.setMaSanPhamMua(listSanPhamMua.get(i).getMaSanPham());
                            chiTietHoaDon.setSoLuongMua(listSanPhamMua.get(i).getSoLuong());
                            SanPham sanPham = SanPhamDAO.getMotSanPham(listSanPhamMua.get(i).getMaSanPham());
                            chiTietHoaDon.setGiaSanPhamMua(listSanPhamMua.get(i).getDonGia());
                            ChiTietHoaDonDAO.themChiTietHoaDon(chiTietHoaDon);
                            SanPham sanPhamCapNhapSoLuong = SanPhamDAO.getMotSanPham(listSanPhamMua.get(i).getMaSanPham());
                            SanPhamDAO.capNhapSoLuongSanPham(listSanPhamMua.get(i).getMaSanPham(), sanPhamCapNhapSoLuong.getSoLuong() - listSanPhamMua.get(i).getSoLuong());
                            //listChiTietHoaDon.add(chiTietHoaDon);
                            // thêm db xong phải thêm vô cột
                            koThanhVienDefaultTableModel.addRow(new Object[]{
                                maHoaDon,
                                tenKhachHang,
                                diaChiKhachHang,
                                soDienThoaiKH,
                                chiTietHoaDon.getMaSanPhamMua(),
                                sanPham.getTenSanPham(),
                                format.format(chiTietHoaDon.getGiaSanPhamMua()),
                                chiTietHoaDon.getSoLuongMua(),
                                format.format(chiTietHoaDon.tinhTien()),
                                hoaDon.getNgayMua(),
                                hoaDon.getMaNhanVienBan()
                            });

                        }
                        sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
                        hoTenBHKTVjTextField.setText("");
                        diaChiBHKTVjTextField.setText("");
                        soDienThoaiBHKTVjTextField.setText("");
                        banHangKTVjTable.clearSelection();

                        JOptionPane.showMessageDialog(null, "Đã thêm", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                    }

                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, "Kiểm tra giá trị nhập vào", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
        }

    }//GEN-LAST:event_themBHKTVjButtonActionPerformed

    private void suaBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_suaBHKTVjButtonActionPerformed
        // TODO add your handling code here:

        try {
            int row = banHangKTVjTable.getSelectedRow();
            if (row != -1) {
                long maHoaDon = Long.parseLong(maDonHangBHKTVjTextField.getText());
                String tenKhachHang = hoTenBHKTVjTextField.getText();
                String diaChiKH = diaChiBHKTVjTextField.getText();
                String soDienThoaiKH = soDienThoaiBHKTVjTextField.getText();
                if (tenKhachHang.equals("") || soDienThoaiKH.equals("")) {
                    JOptionPane.showMessageDialog(null, "Vui lòng điền vào các trường bắt buộc", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                } else {
                    ArrayList<ChiTietHoaDon> listChiTietHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(maHoaDon);

                    ArrayList<SanPham> listSanPhamMua = new ArrayList<>();
                    for (int i = 0; i < sanPhamKhongThanhVienDefaultTableModel.getRowCount(); i++) {
                        SanPham sanPhamMua = new SanPham();
                        sanPhamMua.setMaSanPham(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 1).toString());
                        sanPhamMua.setTenSanPham(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 2).toString());
                        sanPhamMua.setSoLuong(Integer.parseInt(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 3).toString()));
                        sanPhamMua.setDonGia(Double.parseDouble(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 4).toString()));
                        listSanPhamMua.add(sanPhamMua);
                    }

                    for (int i = 0; i < listChiTietHoaDon.size(); i++) {

                        int soLuongMoi = listSanPhamMua.get(i).getSoLuong();
                        int soLuongCu = listChiTietHoaDon.get(i).getSoLuongMua();

                        String maSanPhamMoi = listSanPhamMua.get(i).getMaSanPham();
                        String maSanPhamCu = listChiTietHoaDon.get(i).getMaSanPhamMua();

                        if (maSanPhamCu.equals(maSanPhamMoi)) {

                            if (soLuongMoi > soLuongCu) {
                                int chenhLech = soLuongMoi - soLuongCu;
                                SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPhamCu);
                                SanPhamDAO.capNhapSoLuongSanPham(maSanPhamMoi, sanPham.getSoLuong() - chenhLech);

                            } else if (soLuongMoi < soLuongCu) {
                                int chenhLech = soLuongCu - soLuongMoi;
                                SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPhamCu);
                                SanPhamDAO.capNhapSoLuongSanPham(maSanPhamMoi, sanPham.getSoLuong() + chenhLech);
                                if (soLuongMoi == 0) {
                                    ChiTietHoaDonDAO.xoaMotChiTietHoaDon(maHoaDon, maSanPhamCu);
                                }
                            }
                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                            chiTietHoaDon.setMaSanPhamMua(maSanPhamMoi);
                            SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPhamMoi);
                            chiTietHoaDon.setGiaSanPhamMua(sanPham.getDonGia());
                            chiTietHoaDon.setSoLuongMua(soLuongMoi);
                            ChiTietHoaDonDAO.capNhapMotChiTietHoaDon(maHoaDon, chiTietHoaDon, maSanPhamCu);

                            HoaDonDAO.suaKhachHangKhongThanhVienHoaDon(tenKhachHang, soDienThoaiKH, diaChiKH, maHoaDon);

                        } else {
                            SanPham sanPhamCu = SanPhamDAO.getMotSanPham(maSanPhamCu);
                            SanPhamDAO.capNhapSoLuongSanPham(maSanPhamCu, sanPhamCu.getSoLuong() + soLuongCu);
                            SanPham sanPhamMoi = SanPhamDAO.getMotSanPham(maSanPhamMoi);
                            SanPhamDAO.capNhapSoLuongSanPham(maSanPhamMoi, sanPhamMoi.getSoLuong() - soLuongMoi);

                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                            chiTietHoaDon.setMaSanPhamMua(maSanPhamMoi);
                            chiTietHoaDon.setGiaSanPhamMua(sanPhamMoi.getDonGia());
                            chiTietHoaDon.setSoLuongMua(soLuongMoi);
                            ChiTietHoaDonDAO.capNhapMotChiTietHoaDon(maHoaDon, chiTietHoaDon, maSanPhamCu);

                            HoaDonDAO.suaKhachHangKhongThanhVienHoaDon(tenKhachHang, soDienThoaiKH, diaChiKH, maHoaDon);

                        }

                    }

                    int demSoLuongSanPhamMoi = sanPhamKhongThanhVienDefaultTableModel.getRowCount();
                    if (demSoLuongSanPhamMoi > listChiTietHoaDon.size()) {

                        ArrayList<SanPham> listSanPhamMoi = new ArrayList<>();
                        for (int i = listChiTietHoaDon.size(); i < demSoLuongSanPhamMoi; i++) {
                            SanPham sanPhamMua = new SanPham();
                            sanPhamMua.setMaSanPham(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 1).toString());
                            sanPhamMua.setTenSanPham(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 2).toString());
                            sanPhamMua.setSoLuong(Integer.parseInt(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 3).toString()));
                            sanPhamMua.setDonGia(Double.parseDouble(sanPhamKhongThanhVienDefaultTableModel.getValueAt(i, 4).toString()));
                            listSanPhamMoi.add(sanPhamMua);
                        }
                        for (int i = 0; i < listSanPhamMoi.size(); i++) {
                            ChiTietHoaDon chiTietHoaDon = new ChiTietHoaDon();
                            chiTietHoaDon.setMaHoaDonChiTiet(maHoaDon);
                            chiTietHoaDon.setMaSanPhamMua(listSanPhamMoi.get(i).getMaSanPham());
                            chiTietHoaDon.setSoLuongMua(listSanPhamMoi.get(i).getSoLuong());
                            chiTietHoaDon.setGiaSanPhamMua(listSanPhamMoi.get(i).getDonGia());
                            ChiTietHoaDonDAO.themChiTietHoaDon(chiTietHoaDon);
                            SanPham sanPhamCapNhapSoLuong = SanPhamDAO.getMotSanPham(listSanPhamMoi.get(i).getMaSanPham());
                            SanPhamDAO.capNhapSoLuongSanPham(listSanPhamMoi.get(i).getMaSanPham(), sanPhamCapNhapSoLuong.getSoLuong() - listSanPhamMoi.get(i).getSoLuong());

                        }

                    }

                    loadBanHangKhongThanhVienMotHoaDon(maHoaDon);
                    JOptionPane.showMessageDialog(null, "Đã sửa", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                }

            } else {
                JOptionPane.showMessageDialog(null, "Chọn một đơn hàng để sửa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
        soLuongBHKTVjTextField.setText("");
        maSanPhamBHKTVjComboBox.removeAllItems();
        loadMaSanPhamBHKTV();
        maDonHangBHKTVjTextField.setText("");
        maDonHangBHKTVjTextField.setEditable(false);
        ngayMuaBHKTVjTextField.setText("");
        ngayMuaBHKTVjTextField.setEditable(false);
        hoTenBHKTVjTextField.setText("");
        diaChiBHKTVjTextField.setText("");
        soDienThoaiBHKTVjTextField.setText("");
        huyBHKTVjButton.setEnabled(false);
        themBHKTVjButton.setEnabled(true);
        themSPBHKTVjButton.setEnabled(true);
    }//GEN-LAST:event_suaBHKTVjButtonActionPerformed

    private void banHangKTVjTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_banHangKTVjTableMouseClicked
        // TODO add your handling code here:
        try {
            huyBHKTVjButton.setEnabled(true);
            themBHKTVjButton.setEnabled(false);
            sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
            int row = banHangKTVjTable.getSelectedRow();
            maDonHangBHKTVjTextField.setText(koThanhVienDefaultTableModel.getValueAt(row, 0).toString());
            maDonHangBHKTVjTextField.setEditable(false);
            ngayMuaBHKTVjTextField.setText(koThanhVienDefaultTableModel.getValueAt(row, 9).toString());
            ngayMuaBHKTVjTextField.setEditable(false);
            soLuongBHKTVjTextField.setText(koThanhVienDefaultTableModel.getValueAt(row, 7).toString());

            hoTenBHKTVjTextField.setText(koThanhVienDefaultTableModel.getValueAt(row, 1).toString());
            diaChiBHKTVjTextField.setText(koThanhVienDefaultTableModel.getValueAt(row, 2).toString());
            soDienThoaiBHKTVjTextField.setText(koThanhVienDefaultTableModel.getValueAt(row, 3).toString());

            maSanPhamBHKTVjComboBox.removeAllItems();
            maSanPhamBHKTVjComboBox.addItem(koThanhVienDefaultTableModel.getValueAt(row, 4).toString());
            ArrayList<ChiTietHoaDon> listChiTietHoaDon = ChiTietHoaDonDAO.getMotChiTietHoaDon(Long.parseLong(koThanhVienDefaultTableModel.getValueAt(row, 0).toString()));
            for (int i = 0; i < listChiTietHoaDon.size(); i++) {
                SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietHoaDon.get(i).getMaSanPhamMua());
                sanPhamKhongThanhVienDefaultTableModel.addRow(new Object[]{
                    i + 1,
                    listChiTietHoaDon.get(i).getMaSanPhamMua(),
                    sanPham.getTenSanPham(),
                    listChiTietHoaDon.get(i).getSoLuongMua(),
                    format2.format(listChiTietHoaDon.get(i).getGiaSanPhamMua()),
                    format.format(listChiTietHoaDon.get(i).tinhTien())
                });
            }

            listSanPham = SanPhamDAO.getListSanPham();
            for (int i = 0; i < listSanPham.size(); i++) {
                if (listSanPham.get(i).getMaSanPham().equals(koThanhVienDefaultTableModel.getValueAt(row, 4).toString())) {
                } else {
                    maSanPhamBHKTVjComboBox.addItem(listSanPham.get(i).getMaSanPham());

                }
            }

        } catch (Exception e) {
        }
    }//GEN-LAST:event_banHangKTVjTableMouseClicked

    private void sanPhamBHKTVjTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_sanPhamBHKTVjTableMouseClicked
        // TODO add your handling code here:
        int row = sanPhamBHKTVjTable.getSelectedRow();
        maSanPhamBHKTVjComboBox.removeAllItems();
        maSanPhamBHKTVjComboBox.addItem(sanPhamKhongThanhVienDefaultTableModel.getValueAt(row, 1).toString());
        listSanPham = SanPhamDAO.getListSanPham();
        for (int i = 0; i < listSanPham.size(); i++) {
            if (listSanPham.get(i).getMaSanPham().equals(sanPhamKhongThanhVienDefaultTableModel.getValueAt(row, 1).toString())) {
            } else {
                maSanPhamBHKTVjComboBox.addItem(listSanPham.get(i).getMaSanPham());

            }
        }
        soLuongBHKTVjTextField.setText(sanPhamKhongThanhVienDefaultTableModel.getValueAt(row, 3).toString());
    }//GEN-LAST:event_sanPhamBHKTVjTableMouseClicked

    private void xoaBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xoaBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = banHangKTVjTable.getSelectedRow();
            if (row != -1) {
                long maHoaDon = Long.parseLong(maDonHangBHKTVjTextField.getText());
                int luaChon = JOptionPane.showConfirmDialog(null, "Bạn có chắn chắn muốn xóa không", "Message", JOptionPane.YES_NO_OPTION);
                if (luaChon == JOptionPane.YES_OPTION) {
                    if (HoaDonDAO.xoaHoaDon(maHoaDon)) {
//                        koThanhVienDefaultTableModel.setRowCount(0);
//                        loadBanHang();
                        koThanhVienDefaultTableModel.setRowCount(0);
                        JOptionPane.showMessageDialog(null, "Đã xóa", "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                    } else {
                        JOptionPane.showMessageDialog(null, "Xãy ra lỗi, vui lòng thử lại sau", "Message", JOptionPane.INFORMATION_MESSAGE, dung);

                    }
                } else if (luaChon == JOptionPane.NO_OPTION) {

                    JOptionPane.showMessageDialog(null, "Đã hủy việc xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                }

            } else {
                JOptionPane.showMessageDialog(null, "Chọn một đơn hàng để xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }
        } catch (Exception e) {
        }
        sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
        soLuongBHKTVjTextField.setText("");

        maSanPhamBHKTVjComboBox.removeAllItems();

        loadMaSanPhamBHKTV();

        maDonHangBHKTVjTextField.setText("");
        maDonHangBHKTVjTextField.setEditable(false);
        ngayMuaBHKTVjTextField.setText("");
        ngayMuaBHKTVjTextField.setEditable(false);

        hoTenBHKTVjTextField.setText("");
        diaChiBHKTVjTextField.setText("");
        soDienThoaiBHKTVjTextField.setText("");

        huyBHKTVjButton.setEnabled(false);
        themBHKTVjButton.setEnabled(true);
        themSPBHKTVjButton.setEnabled(true);

    }//GEN-LAST:event_xoaBHKTVjButtonActionPerformed

    public void setMacDinhBHKTV() {
        sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
        soLuongBHKTVjTextField.setText("");

        maSanPhamBHKTVjComboBox.removeAllItems();

        loadMaSanPhamBHKTV();

        maDonHangBHKTVjTextField.setText("");
        maDonHangBHKTVjTextField.setEditable(false);
        ngayMuaBHKTVjTextField.setText("");
        ngayMuaBHKTVjTextField.setEditable(false);

        hoTenBHKTVjTextField.setText("");
        diaChiBHKTVjTextField.setText("");
        soDienThoaiBHKTVjTextField.setText("");

        huyBHKTVjButton.setEnabled(false);
        themBHKTVjButton.setEnabled(true);
        themSPBHKTVjButton.setEnabled(true);
        koThanhVienDefaultTableModel.setRowCount(0);
        banHangKTVjTable.clearSelection();
    }

    private void huyBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_huyBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        setMacDinhBHKTV();

    }//GEN-LAST:event_huyBHKTVjButtonActionPerformed

    private void xuatBHtvjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xuatBHtvjButtonActionPerformed
        // TODO add your handling code here:
        int dem = thanhVienDefaultTableModel.getRowCount();
        if (dem != 0) {
            JFileChooser jFileChooser = new JFileChooser();
            jFileChooser.setCurrentDirectory(new java.io.File("."));
            jFileChooser.setDialogTitle("Chọn thư mục để lưu");
            jFileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            jFileChooser.setAcceptAllFileFilterUsed(false);
            if (jFileChooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {
                Excel.xuatFileExcel(banhangTVjTable, jFileChooser.getSelectedFile() + "\\\\Hoadonthanhvien.xls");
                thanhVienDefaultTableModel.setRowCount(0);
                JOptionPane.showMessageDialog(null, "Đã lưu file tại đường dẫn: " + jFileChooser.getSelectedFile(), "Message", JOptionPane.INFORMATION_MESSAGE, dung);
            } 
        } else {
            JOptionPane.showMessageDialog(null, "Không có hóa đơn nào để xuất");

        }


    }//GEN-LAST:event_xuatBHtvjButtonActionPerformed

    private void xuatBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xuatBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        int dem = koThanhVienDefaultTableModel.getRowCount();
        if (dem != 0) {
            JFileChooser jFileChooser = new JFileChooser();
            jFileChooser.setCurrentDirectory(new java.io.File("."));
            jFileChooser.setDialogTitle("Chọn thư mục để lưu");
            jFileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            jFileChooser.setAcceptAllFileFilterUsed(false);
            if (jFileChooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {
                Excel.xuatFileExcel(banHangKTVjTable, jFileChooser.getSelectedFile() + "\\\\Hoadonkhongthanhvien.xls");
                koThanhVienDefaultTableModel.setRowCount(0);
                JOptionPane.showMessageDialog(null, "Đã lưu file tại đường dẫn: " + jFileChooser.getSelectedFile(), "Message", JOptionPane.INFORMATION_MESSAGE, dung);
            }
        } else {
            JOptionPane.showMessageDialog(null, "Không có hóa đơn nào để xuất");

        }

    }//GEN-LAST:event_xuatBHKTVjButtonActionPerformed

    public boolean soSanhChuoi(String s1, String s2) {
        return s1.length() > s2.length();
    }

    private void inHoaDonBHTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_inHoaDonBHTVjButtonActionPerformed
        // TODO add your handling code here:

        DecimalFormat decimalFormat = new DecimalFormat("###,###,###");

        int kiemTra = thanhVienDefaultTableModel.getRowCount();
        if (kiemTra != 0) {
            String batDau = thanhVienDefaultTableModel.getValueAt(0, 0).toString();
            String ketThuc = thanhVienDefaultTableModel.getValueAt(thanhVienDefaultTableModel.getRowCount() - 1, 0).toString();
            if (batDau.equals(ketThuc)) {
                KhachHang khachHang = KhachHangDAO.getMotKhachHang(thanhVienDefaultTableModel.getValueAt(0, 1).toString());
                String maHoaDon = thanhVienDefaultTableModel.getValueAt(0, 0).toString();
                String maNhanVien = thanhVienDefaultTableModel.getValueAt(0, 9).toString();
                NhanVien nhanVien = NhanVienDAO.getNhanVien(maNhanVien);
                String ngayXuat = thanhVienDefaultTableModel.getValueAt(0, 8).toString();
                ArrayList<ChiTietHoaDon> listChiTiet = ChiTietHoaDonDAO.getMotChiTietHoaDon(Long.parseLong(maHoaDon));
                String tenFile = maHoaDon + ".txt";

                JFileChooser jFileChooser = new JFileChooser();
                jFileChooser.setCurrentDirectory(new java.io.File("."));
                jFileChooser.setDialogTitle("Chọn thư mục để lưu");
                jFileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
                jFileChooser.setAcceptAllFileFilterUsed(false);
                if (jFileChooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {
                    FileWriter fileWriter = null;
                    try {
                        File file = new File(String.valueOf(jFileChooser.getSelectedFile()) + "\\\\" + tenFile);
                        fileWriter = new FileWriter(file);
                        fileWriter.write("\t\tHÓA ĐƠN BÁN HÀNG\r\n");

                        fileWriter.write("-------------------------------------------------------------------\r\n");
                        fileWriter.write("\r\nMã Hóa đơn: " + maHoaDon + "\r\n");
                        fileWriter.write("Ngày mua: " + ngayXuat + "\r\n");
                        fileWriter.write("Mã nhân viên: " + maNhanVien + "\r\n");
                        fileWriter.write("Nhân viên: " + nhanVien.getTenNhanVien() + "\r\n");

                        fileWriter.write("-------------------------------------------------------------------\r\n");
                        fileWriter.write("\r\n");

                        fileWriter.write("Mã khách hàng: " + khachHang.getMaKhachHang() + "\r\n");
                        fileWriter.write("Họ tên: " + khachHang.getTenKhachHang() + "\r\n");
                        fileWriter.write("Số điện thoại: " + khachHang.getSoDienThoaiKH() + "\r\n");
                        fileWriter.write("Địa chỉ: " + khachHang.getDiaChiKhachHang() + "\r\n");
                        fileWriter.write("Email: " + khachHang.getEmailKhachHang() + "\r\n");
                        fileWriter.write("-------------------------------------------------------------------\r\n");

                        fileWriter.write("\r\nDanh sách sản phẩm\r\n");
                        fileWriter.write("STT\t" + "Sản phẩm\t" + "Đơn giá" + "\t\t" + "Số lượng\t" + "Thành tiền\r\n");
                        String tab = "";
                        String tabDG = "";

                        for (int i = 0; i < listChiTiet.size(); i++) {
                            SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTiet.get(i).getMaSanPhamMua());
                            if (soSanhChuoi("Sản phẩm", sanPham.getTenSanPham())) {
                                tab = "\t\t";
                            } else {
                                tab = "\t";
                            }

                            if ("Đơn giá".length() < String.valueOf(decimalFormat.format(listChiTiet.get(i).getGiaSanPhamMua())).length()) {
                                tabDG = "\t";
                            } else {
                                tabDG = "\t\t";
                            }

                            fileWriter.write(i + 1 + ".\t" + sanPham.getTenSanPham() + tab + decimalFormat.format(listChiTiet.get(i).getGiaSanPhamMua()) + tabDG + listChiTiet.get(i).getSoLuongMua() + "\t\t" + decimalFormat.format(listChiTiet.get(i).tinhTien()) + "\r\n");

                        }
                        fileWriter.write("-------------------------------------------------------------------\r\n");

                        HoaDon hoaDon = new HoaDon();
                        fileWriter.write("\t\t\t\t\tTổng tiền: \t" + decimalFormat.format(hoaDon.getTongTien(listChiTiet)));

                        fileWriter.write("\r\n-------------------------------------------------------------------\r\n");
                        fileWriter.write("\r\nXin cảm ơn quý khách\r\nHẹn gặp lại!");
                        fileWriter.close();
                        JOptionPane.showMessageDialog(null, "Đã lưu hóa đơn tại đường dẫn: " + jFileChooser.getSelectedFile(), "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                    } catch (IOException ex) {
                        Logger.getLogger(BanHangJPanel.class.getName()).log(Level.SEVERE, null, ex);
                    } finally {
                        try {
                            fileWriter.close();
                        } catch (IOException ex) {
                            Logger.getLogger(BanHangJPanel.class.getName()).log(Level.SEVERE, null, ex);
                        }
                    }

                    sanPhamThanhVienDefaultTableModel.setRowCount(0);
                    thanhVienDefaultTableModel.setRowCount(0);

                } else {
                    JOptionPane.showMessageDialog(null, "Vui lòng chọn nơi để lưu");

                }
            } else {
                JOptionPane.showMessageDialog(null, "Vui lòng lọc hóa đơn để in");

            }

        } else {
            JOptionPane.showMessageDialog(null, "Không có hóa đơn nào để in", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

        }

    }//GEN-LAST:event_inHoaDonBHTVjButtonActionPerformed

    private void inHoaDonBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_inHoaDonBHKTVjButtonActionPerformed
        // TODO add your handling code here:

        DecimalFormat decimalFormat = new DecimalFormat("###,###,###");

        int kiemTra = banHangKTVjTable.getRowCount();
        if (kiemTra != 0) {
            String batdau = koThanhVienDefaultTableModel.getValueAt(0, 0).toString();
            String ketThuc = koThanhVienDefaultTableModel.getValueAt(koThanhVienDefaultTableModel.getRowCount() - 1, 0).toString();
            if (batdau.equals(ketThuc)) {
                String maHoaDon = koThanhVienDefaultTableModel.getValueAt(0, 0).toString();
                String maNhanVien = koThanhVienDefaultTableModel.getValueAt(0, 10).toString();
                NhanVien nhanVien = NhanVienDAO.getNhanVien(maNhanVien);
                String ngayXuat = koThanhVienDefaultTableModel.getValueAt(0, 9).toString();
                String tenKhachHang = koThanhVienDefaultTableModel.getValueAt(0, 1).toString();
                String diaChiKH = koThanhVienDefaultTableModel.getValueAt(0, 2).toString();
                String soDienThoaiKH = koThanhVienDefaultTableModel.getValueAt(0, 3).toString();
                String tenFile = maHoaDon + ".txt";

                ArrayList<ChiTietHoaDon> listChiTiet = ChiTietHoaDonDAO.getMotChiTietHoaDon(Long.parseLong(maHoaDon));

                JFileChooser jFileChooser = new JFileChooser();
                jFileChooser.setCurrentDirectory(new java.io.File("."));
                jFileChooser.setDialogTitle("Chọn thư mục để lưu");
                jFileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
                jFileChooser.setAcceptAllFileFilterUsed(false);
                if (jFileChooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {
                    FileWriter fileWriter = null;
                    try {
                        File file = new File(String.valueOf(jFileChooser.getSelectedFile()) + "\\\\" + tenFile);
                        fileWriter = new FileWriter(file);
                        fileWriter.write("\t\tHÓA ĐƠN BÁN HÀNG\r\n");

                        fileWriter.write("-------------------------------------------------------------------\r\n");
                        fileWriter.write("\r\nMã Hóa đơn: " + maHoaDon + "\r\n");
                        fileWriter.write("Ngày mua: " + ngayXuat + "\r\n");
                        fileWriter.write("Mã nhân viên: " + maNhanVien + "\r\n");
                        fileWriter.write("Nhân viên: " + nhanVien.getTenNhanVien() + "\r\n");

                        fileWriter.write("-------------------------------------------------------------------\r\n");
                        fileWriter.write("\r\n");

                        fileWriter.write("Họ tên khách hàng: " + tenKhachHang + "\r\n");
                        fileWriter.write("Số điện thoại: " + soDienThoaiKH + "\r\n");
                        fileWriter.write("Địa chỉ: " + diaChiKH + "\r\n");
                        fileWriter.write("-------------------------------------------------------------------\r\n");

                        fileWriter.write("\r\nDanh sách sản phẩm\r\n");
                        fileWriter.write("STT\t" + "Sản phẩm\t" + "Đơn giá" + "\t\t" + "Số lượng\t" + "Thành tiền\r\n");
                        String tab = "";
                        String tabDG = "";

                        for (int i = 0; i < listChiTiet.size(); i++) {
                            SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTiet.get(i).getMaSanPhamMua());
                            if (soSanhChuoi("Sản phẩm", sanPham.getTenSanPham())) {
                                tab = "\t\t";
                            } else {
                                tab = "\t";
                            }

                            if ("Đơn giá".length() < String.valueOf(decimalFormat.format(listChiTiet.get(i).getGiaSanPhamMua())).length()) {
                                tabDG = "\t";
                            } else {
                                tabDG = "\t\t";
                            }

                            fileWriter.write(i + 1 + ".\t" + sanPham.getTenSanPham() + tab + decimalFormat.format(listChiTiet.get(i).getGiaSanPhamMua()) + tabDG + listChiTiet.get(i).getSoLuongMua() + "\t\t" + decimalFormat.format(listChiTiet.get(i).tinhTien()) + "\r\n");

                        }
                        fileWriter.write("-------------------------------------------------------------------\r\n");

                        HoaDon hoaDon = new HoaDon();
                        fileWriter.write("\t\t\t\t\tTổng tiền: \t" + decimalFormat.format(hoaDon.getTongTien(listChiTiet)));

                        fileWriter.write("\r\n-------------------------------------------------------------------\r\n");
                        fileWriter.write("\r\nXin cảm ơn quý khách\r\nHẹn gặp lại!");
                        fileWriter.close();
                        JOptionPane.showMessageDialog(null, "Đã lưu hóa đơn tại đường dẫn: " + jFileChooser.getSelectedFile(), "Message", JOptionPane.INFORMATION_MESSAGE, dung);
                    } catch (IOException ex) {
                        Logger.getLogger(BanHangJPanel.class.getName()).log(Level.SEVERE, null, ex);
                    } finally {
                        try {
                            fileWriter.close();
                        } catch (IOException ex) {
                            Logger.getLogger(BanHangJPanel.class.getName()).log(Level.SEVERE, null, ex);
                        }

                    }
                    sanPhamKhongThanhVienDefaultTableModel.setRowCount(0);
                    koThanhVienDefaultTableModel.setRowCount(0);
                    
                } else {
                    JOptionPane.showMessageDialog(null, "Vui lòng chọn nơi để lưu");

                }
            } else {
                JOptionPane.showMessageDialog(null, "Vui lòng lọc hóa đơn để in");

            }

        } else {
            JOptionPane.showMessageDialog(null, "Không có hóa đơn nào để in", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

        }
    }//GEN-LAST:event_inHoaDonBHKTVjButtonActionPerformed

    private void suaSPBHTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_suaSPBHTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = sanPhamBHTVjTable.getSelectedRow();
            if (row != -1) {
                int kiemTra = banhangTVjTable.getSelectedRow();
                if (kiemTra != -1) {
                    String maSanPham = maSanPhamBHtvjComboBox.getSelectedItem().toString();
                    int soLuong = Integer.parseInt(soLuongBHtvjTextField.getText());
                    if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                        SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                        sanPhamThanhVienDefaultTableModel.setValueAt(maSanPham, row, 1);
                        sanPhamThanhVienDefaultTableModel.setValueAt(sanPham.getTenSanPham(), row, 2);

                        sanPhamThanhVienDefaultTableModel.setValueAt(soLuong, row, 3);
                        sanPhamThanhVienDefaultTableModel.setValueAt(format2.format(sanPham.getDonGia()), row, 4);
                        sanPhamThanhVienDefaultTableModel.setValueAt(format2.format(sanPham.getDonGia() * soLuong), row, 5);

                        maSanPhamBHtvjComboBox.removeAllItems();
                        loadMaSanPham();
                        soLuongBHtvjTextField.setText("");
                    } else {
                        JOptionPane.showMessageDialog(null, "Sản phẩm không còn đủ số lượng", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                    }
                } else {
                    String maSanPham = maSanPhamBHtvjComboBox.getSelectedItem().toString();
                    int soLuong = Integer.parseInt(soLuongBHtvjTextField.getText());
                    if (soLuong == 0) {
                        JOptionPane.showMessageDialog(null, "Kiểm tra lại số lượng", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                    } else if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                        SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                        sanPhamThanhVienDefaultTableModel.setValueAt(maSanPham, row, 1);
                        sanPhamThanhVienDefaultTableModel.setValueAt(sanPham.getTenSanPham(), row, 2);

                        sanPhamThanhVienDefaultTableModel.setValueAt(soLuong, row, 3);
                        sanPhamThanhVienDefaultTableModel.setValueAt(format2.format(sanPham.getDonGia()), row, 4);
                        sanPhamThanhVienDefaultTableModel.setValueAt(format2.format(sanPham.getDonGia() * soLuong), row, 5);

                        maSanPhamBHtvjComboBox.removeAllItems();
                        loadMaSanPham();
                        soLuongBHtvjTextField.setText("");
                    } else {
                        JOptionPane.showMessageDialog(null, "Sản phẩm không còn đủ số lượng", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                    }
                }

            } else {
                JOptionPane.showMessageDialog(null, "Chọn sản phẩm để sửa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }

        } catch (Exception e) {
        }
    }//GEN-LAST:event_suaSPBHTVjButtonActionPerformed

    private void xoaSPBHTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xoaSPBHTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = sanPhamBHTVjTable.getSelectedRow();
            if (row != -1) {
                int luaChon = JOptionPane.showConfirmDialog(null, "Bạn có chắn chắn muốn xóa không", "Message", JOptionPane.YES_NO_OPTION);
                if (luaChon == JOptionPane.YES_OPTION) {
                    sanPhamThanhVienDefaultTableModel.removeRow(row);
                    for (int i = row; i < sanPhamThanhVienDefaultTableModel.getRowCount(); i++) {
                        sanPhamThanhVienDefaultTableModel.setValueAt(i + 1, row, 0);
                    }

                    maSanPhamBHtvjComboBox.removeAllItems();
                    loadMaSanPham();
                    soLuongBHtvjTextField.setText("");

                } else if (luaChon == JOptionPane.NO_OPTION) {
                    JOptionPane.showMessageDialog(null, "Đã hủy việc xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                }
            } else {
                JOptionPane.showMessageDialog(null, "Chọn sản phẩm để xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }
        } catch (Exception e) {
        }
    }//GEN-LAST:event_xoaSPBHTVjButtonActionPerformed

    private void suaSPBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_suaSPBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = sanPhamBHKTVjTable.getSelectedRow();
            if (row != -1) {
                int kiemTra = banHangKTVjTable.getSelectedRow();
                if (kiemTra != -1) {
                    String maSanPham = maSanPhamBHKTVjComboBox.getSelectedItem().toString();
                    int soLuong = Integer.parseInt(soLuongBHKTVjTextField.getText());
                    if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                        SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(maSanPham, row, 1);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(sanPham.getTenSanPham(), row, 2);

                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(soLuong, row, 3);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(format2.format(sanPham.getDonGia()), row, 4);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(format.format(sanPham.getDonGia() * soLuong), row, 5);

                        maSanPhamBHKTVjComboBox.removeAllItems();
                        loadMaSanPhamBHKTV();
                        soLuongBHKTVjTextField.setText("");
                    } else {
                        JOptionPane.showMessageDialog(null, "Sản phẩm không còn đủ số lượng", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                    }
                } else {
                    String maSanPham = maSanPhamBHKTVjComboBox.getSelectedItem().toString();
                    int soLuong = Integer.parseInt(soLuongBHKTVjTextField.getText());
                    if (soLuong == 0) {
                        JOptionPane.showMessageDialog(null, "Kiểm tra lại số lượng", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                    } else if (SanPhamDAO.kiemTraDuSoLuong(maSanPham, soLuong)) {
                        SanPham sanPham = SanPhamDAO.getMotSanPham(maSanPham);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(maSanPham, row, 1);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(sanPham.getTenSanPham(), row, 2);

                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(soLuong, row, 3);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(format2.format(sanPham.getDonGia()), row, 4);
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(format.format(sanPham.getDonGia() * soLuong), row, 5);

                        maSanPhamBHKTVjComboBox.removeAllItems();
                        loadMaSanPhamBHKTV();
                        soLuongBHKTVjTextField.setText("");
                    } else {
                        JOptionPane.showMessageDialog(null, "Sản phẩm không còn đủ số lượng", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

                    }
                }

            } else {
                JOptionPane.showMessageDialog(null, "Chọn sản phẩm để sửa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }

        } catch (Exception e) {
        }
    }//GEN-LAST:event_suaSPBHKTVjButtonActionPerformed

    private void xoaSPBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xoaSPBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            int row = sanPhamBHKTVjTable.getSelectedRow();
            if (row != -1) {
                int luaChon = JOptionPane.showConfirmDialog(null, "Bạn có chắn chắn muốn xóa không", "Message", JOptionPane.YES_NO_OPTION);
                if (luaChon == JOptionPane.YES_OPTION) {
                    sanPhamKhongThanhVienDefaultTableModel.removeRow(row);
                    for (int i = row; i < sanPhamKhongThanhVienDefaultTableModel.getRowCount(); i++) {
                        sanPhamKhongThanhVienDefaultTableModel.setValueAt(i + 1, row, 0);
                    }

                    maSanPhamBHKTVjComboBox.removeAllItems();
                    loadMaSanPhamBHKTV();
                    soLuongBHKTVjTextField.setText("");

                } else if (luaChon == JOptionPane.NO_OPTION) {
                    JOptionPane.showMessageDialog(null, "Đã hủy việc xóa", "Message", JOptionPane.INFORMATION_MESSAGE, sai);
                }
            } else {
                JOptionPane.showMessageDialog(null, "Chọn sản phẩm để xóa");

            }
        } catch (Exception e) {
        }
    }//GEN-LAST:event_xoaSPBHKTVjButtonActionPerformed

    private void xemTatCaDonHangBHTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xemTatCaDonHangBHTVjButtonActionPerformed
        // TODO add your handling code here:
        if (user.getRole() == 1) {
            huyBHtvjButton.setEnabled(true);
            loadBanHangThanhVien();
        } else {
            JOptionPane.showMessageDialog(null, "Bạn không thể dùng chức năng này", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

        }

    }//GEN-LAST:event_xemTatCaDonHangBHTVjButtonActionPerformed

    private void xemTatCaDonHangBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xemTatCaDonHangBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        // TODO add your handling code here:
        if (user.getRole() == 1) {
            huyBHKTVjButton.setEnabled(true);
            loadBanHangKhongThanhVien();
        } else {
            JOptionPane.showMessageDialog(null, "Bạn không thể dùng chức năng này", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

        }
    }//GEN-LAST:event_xemTatCaDonHangBHKTVjButtonActionPerformed

    private void locDonHangBHTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_locDonHangBHTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            if (user.getRole() == 1) {
                int row = banhangTVjTable.getSelectedRow();
                if (row != -1) {
                    long maHoaDon = Long.parseLong(thanhVienDefaultTableModel.getValueAt(row, 0).toString());
                    HoaDon hoaDon = HoaDonDAO.getHoaDon(maHoaDon);
                    KhachHang khachHang = KhachHangDAO.getMotKhachHang(hoaDon.getMaKhachHangMua());
                    ArrayList<ChiTietHoaDon> listChiTietHD = ChiTietHoaDonDAO.getMotChiTietHoaDon(maHoaDon);
                    setMacDinhBHTV();
                    for (int i = 0; i < listChiTietHD.size(); i++) {
                        SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietHD.get(i).getMaSanPhamMua());
                        thanhVienDefaultTableModel.addRow(new Object[]{
                            maHoaDon,
                            hoaDon.getMaKhachHangMua(),
                            khachHang.getTenKhachHang(),
                            listChiTietHD.get(i).getMaSanPhamMua(),
                            sanPham.getTenSanPham(),
                            format.format(listChiTietHD.get(i).getGiaSanPhamMua()),
                            listChiTietHD.get(i).getSoLuongMua(),
                            format.format(listChiTietHD.get(i).tinhTien()),
                            hoaDon.getNgayMua(),
                            hoaDon.getMaNhanVienBan()

                        });
                    }
                } else {
                    JOptionPane.showMessageDialog(null, "Chọn một hóa đơn để lọc");

                }
            } else {
                JOptionPane.showMessageDialog(null, "Bạn không thể dùng chức năng này", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }

        } catch (Exception e) {
        }
    }//GEN-LAST:event_locDonHangBHTVjButtonActionPerformed

    private void locDonHangBHKTVjButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_locDonHangBHKTVjButtonActionPerformed
        // TODO add your handling code here:
        try {
            if (user.getRole() == 1) {
                int row = banHangKTVjTable.getSelectedRow();
                if (row != -1) {
                    long maHoaDon = Long.parseLong(koThanhVienDefaultTableModel.getValueAt(row, 0).toString());
                    HoaDon hoaDon = HoaDonDAO.getHoaDon(maHoaDon);
                    ArrayList<ChiTietHoaDon> listChiTietHD = ChiTietHoaDonDAO.getMotChiTietHoaDon(maHoaDon);
                    setMacDinhBHKTV();
                    for (int i = 0; i < listChiTietHD.size(); i++) {
                        SanPham sanPham = SanPhamDAO.getMotSanPham(listChiTietHD.get(i).getMaSanPhamMua());
                        koThanhVienDefaultTableModel.addRow(new Object[]{
                            maHoaDon,
                            hoaDon.getTenKhachHangMua(),
                            hoaDon.getDiaChiKhachHangMua(),
                            hoaDon.getSoDienThoaiKH(),
                            listChiTietHD.get(i).getMaSanPhamMua(),
                            sanPham.getTenSanPham(),
                            format.format(listChiTietHD.get(i).getGiaSanPhamMua()),
                            listChiTietHD.get(i).getSoLuongMua(),
                            format.format(listChiTietHD.get(i).tinhTien()),
                            hoaDon.getNgayMua(),
                            hoaDon.getMaNhanVienBan()

                        });
                    }
                } else {
                    JOptionPane.showMessageDialog(null, "Chọn một hóa đơn để lọc");

                }
            } else {
                JOptionPane.showMessageDialog(null, "Bạn không thể dùng chức năng này", "Message", JOptionPane.INFORMATION_MESSAGE, sai);

            }

        } catch (Exception e) {
        }
    }//GEN-LAST:event_locDonHangBHKTVjButtonActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable banHangKTVjTable;
    private javax.swing.JTable banhangTVjTable;
    private javax.swing.JLabel diaChiBHKTVjLabel;
    private javax.swing.JTextField diaChiBHKTVjTextField;
    private javax.swing.JLabel hoTenBHKTVjLabel;
    private javax.swing.JTextField hoTenBHKTVjTextField;
    private javax.swing.JButton huyBHKTVjButton;
    private javax.swing.JButton huyBHtvjButton;
    private javax.swing.JButton inHoaDonBHKTVjButton;
    private javax.swing.JButton inHoaDonBHTVjButton;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JPanel khongThanhVienjPanel;
    private javax.swing.JButton locDonHangBHKTVjButton;
    private javax.swing.JButton locDonHangBHTVjButton;
    private javax.swing.JLabel maDonHangBHKTVjLabel;
    private javax.swing.JTextField maDonHangBHKTVjTextField;
    private javax.swing.JLabel maDonHangBHtvjLabel;
    private javax.swing.JTextField maDonHangBHtvjTextField;
    private javax.swing.JComboBox<String> maKhachHangBHTVjComboBox;
    private javax.swing.JLabel maKhachHangBHtvjLabel;
    private javax.swing.JLabel maNhanVienBHKTVjLabel;
    private javax.swing.JTextField maNhanVienBHKTVjTextField;
    private javax.swing.JTextField maNhanVienBHTVjTextField;
    private javax.swing.JLabel maNhanVienBHtvjLabel;
    private javax.swing.JComboBox<String> maSanPhamBHKTVjComboBox;
    private javax.swing.JLabel maSanPhamBHKTVjLabel;
    private javax.swing.JComboBox<String> maSanPhamBHtvjComboBox;
    private javax.swing.JLabel maSanPhamBHtvjLabel;
    private javax.swing.JTextField ngayMuaBHKTVjTextField;
    private javax.swing.JTextField ngayMuaBHTVjTextField;
    private javax.swing.JLabel ngayMuaBHtvjLabel;
    private javax.swing.JLabel ngayMuaBHtvjLabel1;
    private javax.swing.JTable sanPhamBHKTVjTable;
    private javax.swing.JTable sanPhamBHTVjTable;
    private javax.swing.JLabel soDienThoaiBHKTVjLabel;
    private javax.swing.JTextField soDienThoaiBHKTVjTextField;
    private javax.swing.JTextField soLuongBHKTVjTextField;
    private javax.swing.JLabel soLuongBHktvjLabel;
    private javax.swing.JLabel soLuongBHtvjLabel;
    private javax.swing.JTextField soLuongBHtvjTextField;
    private javax.swing.JButton suaBHKTVjButton;
    private javax.swing.JButton suaBHtvjButton;
    private javax.swing.JButton suaSPBHKTVjButton;
    private javax.swing.JButton suaSPBHTVjButton;
    private javax.swing.JPanel thanhVienjPanel;
    private javax.swing.JButton themBHKTVjButton;
    private javax.swing.JButton themBHtvjButton;
    private javax.swing.JButton themSPBHKTVjButton;
    private javax.swing.JButton themSPBHTVjButton;
    private javax.swing.JButton xemTatCaDonHangBHKTVjButton;
    private javax.swing.JButton xemTatCaDonHangBHTVjButton;
    private javax.swing.JButton xoaBHKTVjButton;
    private javax.swing.JButton xoaBHtvjButton;
    private javax.swing.JButton xoaSPBHKTVjButton;
    private javax.swing.JButton xoaSPBHTVjButton;
    private javax.swing.JButton xuatBHKTVjButton;
    private javax.swing.JButton xuatBHtvjButton;
    // End of variables declaration//GEN-END:variables
}
